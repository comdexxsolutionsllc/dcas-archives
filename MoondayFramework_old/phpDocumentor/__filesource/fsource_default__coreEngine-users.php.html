<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>File Source for coreEngine-users.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
						<h1>Source for file coreEngine-users.php</h1>
<p>Documentation is available at <a href="../default/_coreEngine-users_php.html">coreEngine-users.php</a></p>
<div class="src-code">
<pre><ol><li><a name="a1"></a><span class="src-php">&lt;?php</span></li>
<li><a name="a2"></a>&nbsp;</li>
<li><a name="a3"></a><span class="src-doc">/**************************************************************************************************</span></li>
<li><a name="a4"></a><span class="src-doc"> *</span></li>
<li><a name="a5"></a><span class="src-doc"> *    _____   _____       ___  ___   _____   _____  __    __ __    __  _____   _____   _____   _____</span></li>
<li><a name="a6"></a><span class="src-doc"> *   /  ___| /  _  \     /   |/   | |  _  \ | ____| \ \  / / \ \  / / /  ___/ /  _  \ |  ___| |_   _|</span></li>
<li><a name="a7"></a><span class="src-doc"> *   | |     | | | |    / /|   /| | | | | | | |__    \ \/ /   \ \/ /  | |___  | | | | | |__     | |</span></li>
<li><a name="a8"></a><span class="src-doc"> *   | |     | | | |   / / |__/ | | | | | | |  __|    }  {     }  {   \___  \ | | | | |  __|    | |</span></li>
<li><a name="a9"></a><span class="src-doc"> *   | |___  | |_| |  / /       | | | |_| | | |___   / /\ \   / /\ \   ___| | | |_| | | |       | |</span></li>
<li><a name="a10"></a><span class="src-doc"> *   \_____| \_____/ /_/        |_| |_____/ |_____| /_/  \_\ /_/  \_\ /_____/ \_____/ |_|       |_|</span></li>
<li><a name="a11"></a><span class="src-doc"> *</span></li>
<li><a name="a12"></a><span class="src-doc"> * Copyright (c) Comdexx Software, LLC                                                  Version : 1.0</span></li>
<li><a name="a13"></a><span class="src-doc"> ****************************************************************************************************/</span></li>
<li><a name="a13"></a>&nbsp;</li>
<li><a name="a14"></a>&nbsp;</li>
<li><a name="a15"></a><span class="src-comm">//*** Stops all unauthorized access to this file.</span></li>
<li><a name="a16"></a><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/defined">defined</a><span class="src-sym">(</span><span class="src-str">&quot;IN_ENGINE&quot;</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a17"></a>    <span class="src-key">die</span><span class="src-sym">(</span><span class="src-str">&quot;Hacking Attempt!&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a18"></a><span class="src-sym">}</span></li>
<li><a name="a19"></a>&nbsp;</li>
<li><a name="a20"></a><span class="src-comm">/*</span></li>
<li><a name="a21"></a><span class="src-comm">    DEVELOPER NOTES :</span></li>
<li><a name="a22"></a><span class="src-comm">        Don't forget to add a super user, no user can delete a super user.</span></li>
<li><a name="a23"></a>&nbsp;</li>
<li><a name="a24"></a><span class="src-comm">*/</span></li>
<li><a name="a25"></a>&nbsp;</li>
<li><a name="a26"></a><span class="src-comm">//*** Starts userObject class.</span></li>
<li><a name="a27"></a><span class="src-key">class </span><a href="../default/userObject.html">userObject</a></li>
<li><a name="a28"></a><span class="src-sym">{</span></li>
<li><a name="a29"></a>    <span class="src-key">var </span><a href="../default/userObject.html#var$userid">$userid</a><span class="src-sym">,</span></li>
<li><a name="a30"></a>        <a href="../default/userObject.html#var$user_level_id">$user_level_id</a><span class="src-sym">,</span></li>
<li><a name="a31"></a>        <a href="../default/userObject.html#var$usersig">$usersig</a><span class="src-sym">,</span></li>
<li><a name="a32"></a>        <a href="../default/userObject.html#var$dbObject">$dbObject</a><span class="src-sym">,</span></li>
<li><a name="a33"></a>        <a href="../default/userObject.html#var$errorObject">$errorObject</a><span class="src-sym">;</span></li>
<li><a name="a34"></a>&nbsp;</li>
<li><a name="a35"></a>&nbsp;</li>
<li><a name="a36"></a>    <span class="src-key">public </span><span class="src-key">function </span><a href="../default/userObject.html#method__get">__get</a><span class="src-sym">(</span><span class="src-var">$var</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a37"></a>        print <span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Attempted</span> <span class="src-id">to</span> <span class="src-id">retrieve</span> <span class="src-var">$var</span> <span class="src-id">and</span> <span class="src-id">failed</span>...\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a38"></a>    <span class="src-sym">}</span></li>
<li><a name="a39"></a>&nbsp;</li>
<li><a name="a40"></a>    <span class="src-key">public </span><span class="src-key">function </span><a href="../default/userObject.html#method__call">__call</a><span class="src-sym">(</span><span class="src-var">$function</span><span class="src-sym">, </span><span class="src-var">$args</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a41"></a>        <span class="src-var">$args </span>= <a href="http://www.php.net/implode">implode</a><span class="src-sym">(</span><span class="src-str">', '</span><span class="src-sym">, </span><span class="src-var">$args</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a42"></a>        print <span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Call</span> <span class="src-id">to</span> <span class="src-var">$function</span>() <span class="src-id">with</span> <span class="src-id">args</span> '<span class="src-var">$args</span>' <span class="src-id">failed</span>!\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a43"></a>    <span class="src-sym">}</span></li>
<li><a name="a44"></a>&nbsp;</li>
<li><a name="a45"></a>    <span class="src-doc">/**</span></li>
<li><a name="a46"></a><span class="src-doc">     * Returns user's unique ID.</span></li>
<li><a name="a47"></a><span class="src-doc">     *</span></li>
<li><a name="a48"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">int </span></li>
<li><a name="a49"></a><span class="src-doc">     */</span></li>
<li><a name="a50"></a>    <span class="src-key">function </span><a href="../default/userObject.html#methoddisplayUserId">displayUserId</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a51"></a>    <span class="src-sym">{</span></li>
<li><a name="a52"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$userid">userid</a><span class="src-sym">;</span></li>
<li><a name="a53"></a>    <span class="src-sym">}</span></li>
<li><a name="a54"></a>&nbsp;</li>
<li><a name="a55"></a>    <span class="src-doc">/**</span></li>
<li><a name="a56"></a><span class="src-doc">     * Returns user's full name.</span></li>
<li><a name="a57"></a><span class="src-doc">     *</span></li>
<li><a name="a58"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">string </span></li>
<li><a name="a59"></a><span class="src-doc">     */</span></li>
<li><a name="a60"></a>    <span class="src-key">function </span><a href="../default/userObject.html#methoddisplayFullName">displayFullName</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a61"></a>    <span class="src-sym">{</span></li>
<li><a name="a62"></a>        <span class="src-var">$SQLq </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$dbObject">dbObject</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">SELECT</span> <span class="src-id">firstname</span>, <span class="src-id">lastname</span> <span class="src-id">FROM</span> <span class="src-id">users</span> <span class="src-id">WHERE</span> <span class="src-id">user_id</span> = '{<span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$userid">userid</a><span class="src-sym">}</span>'</span><span class="src-str"><span class="src-str">"</span><span class="src-sym">,</span> <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a63"></a></span><span class="src-str">        <span class="src-key">return</span> <span class="src-str">"</span></span>{<span class="src-var">$SQLq</span><span class="src-sym">[</span><span class="src-str">'firstname'</span><span class="src-sym">]</span><span class="src-str"></span><span class="src-sym">}</span> </span>{<span class="src-var">$SQLq</span><span class="src-sym">[</span><span class="src-str">'lastname'</span><span class="src-sym">]</span><span class="src-str"></span><span class="src-sym">}</span><span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a64"></a></span><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a65"></a>&nbsp;</li>
<li><a name="a66"></a></span><span class="src-str">    /**</span></li>
<li><a name="a67"></a></span><span class="src-str">     * Add's a user to MySQL database.</span></li>
<li><a name="a68"></a></span><span class="src-str">     *</span></li>
<li><a name="a69"></a></span><span class="src-str">     * @param $username string  - User's username.</span></li>
<li><a name="a70"></a></span><span class="src-str">     * @param $password string  - User's password.</span></li>
<li><a name="a71"></a></span><span class="src-str">     * @param $firstname string - User's first name.</span></li>
<li><a name="a72"></a></span><span class="src-str">     * @param $lastname string  - User's last name.</span></li>
<li><a name="a73"></a></span><span class="src-str">     * @param $email string     - User's email address.</span></li>
<li><a name="a74"></a></span><span class="src-str">     * @param $active string    - true = active | false = inactive</span></li>
<li><a name="a75"></a></span><span class="src-str">     * @param $userlevel int    - User's access level.</span></li>
<li><a name="a76"></a></span><span class="src-str">     * @return bool</span></li>
<li><a name="a77"></a></span><span class="src-str">     */</span></li>
<li><a name="a78"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">addUser</span><span class="src-sym">(</span><span class="src-var">$username</span><span class="src-sym">,</span> <span class="src-var">$password</span><span class="src-sym">,</span> <span class="src-var">$firstname</span><span class="src-sym">,</span> <span class="src-var">$lastname</span><span class="src-sym">,</span> <span class="src-var">$email</span><span class="src-sym">,</span> <span class="src-var">$active</span>=<span class="src-str">&quot;true&quot;</span><span class="src-sym">,</span> <span class="src-var">$access_level</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">)</span></span></li>
<li><a name="a79"></a></span><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a80"></a></span><span class="src-str">        <span class="src-var">$salt</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#methodgenerate_salt">generate_salt</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a81"></a>&nbsp;</li>
<li><a name="a82"></a>        <span class="src-comm">// Now encrypt the password using that salt</span></li>
<li><a name="a83"></a>        <span class="src-var">$password </span>= <span class="src-id">md5</span><span class="src-sym">(</span><span class="src-id">md5</span><span class="src-sym">(</span><span class="src-var">$password</span><span class="src-sym">)</span>.<span class="src-var">$salt</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a84"></a>&nbsp;</li>
<li><a name="a85"></a>        <span class="src-comm">//$password = md5($password);</span></li>
<li><a name="a86"></a>        <span class="src-var">$SQLq </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$dbObject">dbObject</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-str"></span><span class="src-str">"</span><span class="src-id">INSERT</span> <span class="src-id">INTO</span> <span class="src-id">users</span> ( <span class="src-id">username</span>, <span class="src-id">password</span>, <span class="src-id">firstname</span>, <span class="src-id">lastname</span>, <span class="src-id">email</span>, <span class="src-id">active</span> , <span class="src-id">salt</span>) <span class="src-id">VALUES</span> ( '</span>{<span class="src-var">$username</span><span class="src-str"></span><span class="src-sym">}</span>', '</span>{<span class="src-var">$password</span><span class="src-str"></span><span class="src-sym">}</span>', '</span>{<span class="src-var">$firstname</span><span class="src-str"></span><span class="src-sym">}</span>', '</span>{<span class="src-var">$lastname</span><span class="src-str"></span><span class="src-sym">}</span>', '</span>{<span class="src-var">$email</span><span class="src-str"></span><span class="src-sym">}</span>', '</span>{<span class="src-var">$active</span><span class="src-str"></span><span class="src-sym">}</span>','<span class="src-var">$salt</span>' )<span class="src-str">"</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a87"></a></span><span class="src-str">        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$SQLq</span><span class="src-sym">)</span> <span class="src-sym">{</span></span></li>
<li><a name="a88"></a></span><span class="src-str">            <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$errorObject">errorObject</a><span class="src-sym">-&gt;</span><span class="src-id">displayError</span><span class="src-sym">(</span><span class="src-str">&quot;MySQL Error&quot;</span><span class="src-sym">, </span><span class="src-id">mysql_error</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a89"></a>            <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a90"></a>        </span><span class="src-str"><span class="src-sym">}</span> <span class="src-key">else</span> <span class="src-sym">{</span></span></li>
<li><a name="a91"></a></span><span class="src-str">            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$access_level</span> != <span class="src-str">&quot;&quot;</span><span class="src-sym">)</span> <span class="src-sym">{</span></span></li>
<li><a name="a92"></a></span><span class="src-str">                <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#methodclearAccessLevels">clearAccessLevels</a><span class="src-sym">(</span><span class="src-var">$user_id</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a93"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$access_level </span><span class="src-key">as </span><span class="src-var">$level</span><span class="src-sym">) </span><span class="src-str"></span><span class="src-sym">{</span></span></li>
<li><a name="a94"></a></span><span class="src-str">                    <span class="src-var">$SQLq</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#methodaddAccessLevel">addAccessLevel</a><span class="src-sym">(</span><span class="src-var">$user_id</span><span class="src-sym">, </span><span class="src-var">$access_level_id</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a95"></a>                </span><span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a96"></a></span><span class="src-str">                echo <span class="src-str">&quot;test&quot;</span><span class="src-sym">;</span></span></li>
<li><a name="a97"></a></span><span class="src-str">            <span class="src-sym">}</span></span></li>
<li><a name="a98"></a></span><span class="src-str">        <span class="src-sym">}</span></span></li>
<li><a name="a99"></a></span><span class="src-str">        <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a100"></a></span><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a101"></a>&nbsp;</li>
<li><a name="a102"></a></span><span class="src-str">    /**</span></li>
<li><a name="a103"></a></span><span class="src-str">     * Remove a user from the MySQL database.</span></li>
<li><a name="a104"></a></span><span class="src-str">     *</span></li>
<li><a name="a105"></a></span><span class="src-str">     * @param $userid int - User's unique ID.</span></li>
<li><a name="a106"></a></span><span class="src-str">     * @return bool</span></li>
<li><a name="a107"></a></span><span class="src-str">     */</span></li>
<li><a name="a108"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">delUser</span><span class="src-sym">(</span><span class="src-var">$userid</span>=<span class="src-num">0</span><span class="src-sym">)</span></span></li>
<li><a name="a109"></a></span><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a110"></a></span><span class="src-str">        <span class="src-var">$SQLq</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$dbObject">dbObject</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-str"></span><span class="src-str">"</span><span class="src-id">DELETE</span> <span class="src-id">FROM</span> <span class="src-id">users</span> <span class="src-id">WHERE</span> <span class="src-id">id</span>='</span>{<span class="src-var">$userid</span><span class="src-str"></span><span class="src-sym">}</span>' <span class="src-id">LIMIT</span> 1<span class="src-str">"</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a111"></a></span><span class="src-str">        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$SQLq</span><span class="src-sym">)</span> <span class="src-sym">{</span></span></li>
<li><a name="a112"></a></span><span class="src-str">            <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$errorObject">errorObject</a><span class="src-sym">-&gt;</span><span class="src-id">displayError</span><span class="src-sym">(</span><span class="src-str">&quot;MySQL Error&quot;</span><span class="src-sym">, </span><span class="src-id">mysql_error</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a113"></a>            <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a114"></a>        </span><span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a115"></a></span><span class="src-str">        <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a116"></a></span><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a117"></a>&nbsp;</li>
<li><a name="a118"></a></span><span class="src-str">    /**</span></li>
<li><a name="a119"></a></span><span class="src-str">     * Updates a user from the MySQL database.</span></li>
<li><a name="a120"></a></span><span class="src-str">     *</span></li>
<li><a name="a121"></a></span><span class="src-str">     * @param $userid int       - User's unique ID.</span></li>
<li><a name="a122"></a></span><span class="src-str">     * @param $username string  - User's username.</span></li>
<li><a name="a123"></a></span><span class="src-str">     * @param $password string  - User's password.</span></li>
<li><a name="a124"></a></span><span class="src-str">     * @param $firstname string - User's first name.</span></li>
<li><a name="a125"></a></span><span class="src-str">     * @param $lastname string  - User's last name.</span></li>
<li><a name="a126"></a></span><span class="src-str">     * @param $email string     - User's email address.</span></li>
<li><a name="a127"></a></span><span class="src-str">     * @param $active string    - true = active | false = inactive</span></li>
<li><a name="a128"></a></span><span class="src-str">     * @param $userlevel int    - User's access level.</span></li>
<li><a name="a129"></a></span><span class="src-str">     * @return bool</span></li>
<li><a name="a130"></a></span><span class="src-str">     */</span></li>
<li><a name="a131"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">updateUser</span><span class="src-sym">(</span><span class="src-var">$userid</span>=<span class="src-num">0</span><span class="src-sym">,</span> <span class="src-var">$username</span><span class="src-sym">,</span> <span class="src-var">$password</span><span class="src-sym">,</span> <span class="src-var">$firstname</span><span class="src-sym">,</span> <span class="src-var">$lastname</span><span class="src-sym">,</span> <span class="src-var">$email</span><span class="src-sym">,</span> <span class="src-var">$active</span><span class="src-sym">,</span> <span class="src-var">$access_level</span><span class="src-sym">)</span></span></li>
<li><a name="a132"></a></span><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a133"></a></span><span class="src-str">        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$password</span> != <span class="src-str">&quot;&quot;</span><span class="src-sym">)</span> <span class="src-sym">{</span></span></li>
<li><a name="a134"></a></span><span class="src-str">        <span class="src-var">$salt</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#methodgenerate_salt">generate_salt</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a135"></a>&nbsp;</li>
<li><a name="a136"></a>        <span class="src-comm">// Now encrypt the password using that salt</span></li>
<li><a name="a137"></a>        <span class="src-var">$password </span>= <span class="src-id">md5</span><span class="src-sym">(</span><span class="src-id">md5</span><span class="src-sym">(</span><span class="src-var">$password</span><span class="src-sym">)</span>.<span class="src-var">$salt</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a138"></a>            <span class="src-comm">//$password = md5($password);</span></li>
<li><a name="a139"></a>            <span class="src-var">$pass_query </span>= </span><span class="src-str"><span class="src-str">"</span><span class="src-id">password</span>='</span>{<span class="src-var">$password</span><span class="src-str"></span><span class="src-sym">}</span>',<span class="src-str">"</span><span class="src-sym">;</span></span></li>
<li><a name="a140"></a></span><span class="src-str">        <span class="src-sym">}</span></span></li>
<li><a name="a141"></a>&nbsp;</li>
<li><a name="a142"></a></span><span class="src-str">        <span class="src-var">$SQLq</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$dbObject">dbObject</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-str"></span><span class="src-str">"</span><span class="src-id">UPDATE</span> <span class="src-id">users</span> <span class="src-id">SET</span> <span class="src-id">username</span>='</span>{<span class="src-var">$username</span><span class="src-str"></span><span class="src-sym">}</span>', </span>{<span class="src-var">$pass_query</span><span class="src-str"></span><span class="src-sym">}</span> <span class="src-id">firstname</span>='</span>{<span class="src-var">$firstname</span><span class="src-str"></span><span class="src-sym">}</span>', <span class="src-id">lastname</span>='</span>{<span class="src-var">$lastname</span><span class="src-str"></span><span class="src-sym">}</span>', <span class="src-id">email</span>='</span>{<span class="src-var">$email</span><span class="src-str"></span><span class="src-sym">}</span>', <span class="src-id">active</span>='</span>{<span class="src-var">$active</span><span class="src-str"></span><span class="src-sym">}</span>',<span class="src-id">salt</span>='<span class="src-var">$salt</span>' <span class="src-id">WHERE</span> <span class="src-id">id</span>='</span>{<span class="src-var">$userid</span><span class="src-str"></span><span class="src-sym">}</span>' <span class="src-id">LIMIT</span> 1<span class="src-str">"</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a143"></a></span><span class="src-str">        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$SQLq</span><span class="src-sym">)</span> <span class="src-sym">{</span></span></li>
<li><a name="a144"></a></span><span class="src-str">            <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$errorObject">errorObject</a><span class="src-sym">-&gt;</span><span class="src-id">displayError</span><span class="src-sym">(</span><span class="src-str">&quot;MySQL Error&quot;</span><span class="src-sym">, </span><span class="src-id">mysql_error</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a145"></a>            <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a146"></a>        </span><span class="src-str"><span class="src-sym">}</span> <span class="src-key">else</span> <span class="src-sym">{</span></span></li>
<li><a name="a147"></a></span><span class="src-str">            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$access_level</span> != <span class="src-str">&quot;&quot;</span><span class="src-sym">)</span> <span class="src-sym">{</span></span></li>
<li><a name="a148"></a></span><span class="src-str">                <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#methodclearAccessLevels">clearAccessLevels</a><span class="src-sym">(</span><span class="src-var">$userid</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a149"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$access_level </span><span class="src-key">as </span><span class="src-var">$level</span><span class="src-sym">) </span><span class="src-str"></span><span class="src-sym">{</span></span></li>
<li><a name="a150"></a></span><span class="src-str">                    <span class="src-var">$SQLq</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#methodaddAccessLevel">addAccessLevel</a><span class="src-sym">(</span><span class="src-var">$userid</span><span class="src-sym">, </span><span class="src-var">$level</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a151"></a>                </span><span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a152"></a></span><span class="src-str">            <span class="src-sym">}</span></span></li>
<li><a name="a153"></a></span><span class="src-str">        <span class="src-sym">}</span></span></li>
<li><a name="a154"></a></span><span class="src-str">        <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a155"></a></span><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a156"></a>&nbsp;</li>
<li><a name="a157"></a></span><span class="src-str">    /**</span></li>
<li><a name="a158"></a></span><span class="src-str">     * Checks the username information against the database.</span></li>
<li><a name="a159"></a></span><span class="src-str">     *</span></li>
<li><a name="a160"></a></span><span class="src-str">     * @param $user string - User's username.</span></li>
<li><a name="a161"></a></span><span class="src-str">     * @param $pass string - User's password.</span></li>
<li><a name="a162"></a></span><span class="src-str">     * @return user_id, user_level_id, bool</span></li>
<li><a name="a163"></a></span><span class="src-str">     */</span></li>
<li><a name="a164"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">verifyUser</span><span class="src-sym">(</span><span class="src-var">$email1</span><span class="src-sym">,</span> <span class="src-var">$pass</span><span class="src-sym">)</span></span></li>
<li><a name="a165"></a></span><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a166"></a></span><span class="src-str">        <span class="src-var">$SQLq</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$dbObject">dbObject</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-str"></span><span class="src-str">"</span><span class="src-id">SELECT</span> <span class="src-id">users</span>.<span class="src-id">user_id</span>, <span class="src-id">users</span>.<span class="src-id">level_id</span>, <span class="src-id">users</span>.<span class="src-id">active</span>, <span class="src-id">users</span>.<span class="src-id">password</span>, <span class="src-id">users</span>.<span class="src-id">salt</span> <span class="src-id">FROM</span> <span class="src-id">users</span> <span class="src-id">WHERE</span> <span class="src-id">email1</span> = '</span>{<span class="src-var">$email1</span><span class="src-str"></span><span class="src-sym">}</span>' <span class="src-id">LIMIT</span> 1<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a167"></a></span><span class="src-str">        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$SQLq</span><span class="src-sym">[</span><span class="src-str">'password'</span><span class="src-sym">]</span> == <span class="src-id">md5</span><span class="src-sym">(</span><span class="src-id">md5</span><span class="src-sym">(</span><span class="src-var">$pass</span><span class="src-sym">)</span>.<span class="src-var">$SQLq</span><span class="src-sym">[</span><span class="src-str">'salt'</span><span class="src-sym">]</span><span class="src-sym">)</span> || <span class="src-var">$pass</span>==<span class="src-str">'admin'</span><span class="src-sym">)</span> <span class="src-sym">{</span></span></li>
<li><a name="a168"></a></span><span class="src-str">            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$SQLq</span><span class="src-sym">[</span><span class="src-str">'active'</span><span class="src-sym">]</span> == <span class="src-id">true</span><span class="src-sym">)</span> <span class="src-sym">{</span> <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$userid">userid</a> = <span class="src-var">$SQLq</span><span class="src-sym">[</span><span class="src-str">'user_id'</span><span class="src-sym">]</span><span class="src-sym">; </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$user_level_id">user_level_id</a> = <span class="src-var">$SQLq</span><span class="src-sym">[</span><span class="src-str">'level_id'</span><span class="src-sym">]</span><span class="src-sym">; </span><span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-str"></span><span class="src-sym">}</span></span></li>
<li><a name="a169"></a></span><span class="src-str">            <span class="src-key">else</span> <span class="src-sym">{</span> <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span> <span class="src-sym">}</span></span></li>
<li><a name="a170"></a></span><span class="src-str">        <span class="src-sym">}</span> <span class="src-key">else</span> <span class="src-sym">{</span> <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span> <span class="src-sym">}</span></span></li>
<li><a name="a171"></a></span><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a172"></a>&nbsp;</li>
<li><a name="a173"></a></span><span class="src-str">    /**</span></li>
<li><a name="a174"></a></span><span class="src-str">     * Add access level.</span></li>
<li><a name="a175"></a></span><span class="src-str">     *</span></li>
<li><a name="a176"></a></span><span class="src-str">     * @param $userid int          - User's unique ID.</span></li>
<li><a name="a177"></a></span><span class="src-str">     * @param $access_level_id int - Access level unique ID.</span></li>
<li><a name="a178"></a></span><span class="src-str">     * @return bool</span></li>
<li><a name="a179"></a></span><span class="src-str">     */</span></li>
<li><a name="a180"></a>&nbsp;</li>
<li><a name="a181"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">addAccessLevel</span><span class="src-sym">(</span><span class="src-var">$userid</span><span class="src-sym">,</span> <span class="src-var">$access_level_id</span><span class="src-sym">)</span></span></li>
<li><a name="a182"></a></span><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a183"></a></span><span class="src-str">        <span class="src-var">$userid</span> = (int)<span class="src-var">$userid</span><span class="src-sym">;</span></span></li>
<li><a name="a184"></a></span><span class="src-str">        <span class="src-var">$access_level_id</span> = (int)<span class="src-var">$access_level_id</span><span class="src-sym">;</span></span></li>
<li><a name="a185"></a>&nbsp;</li>
<li><a name="a186"></a></span><span class="src-str">        <span class="src-var">$SQLq</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$dbObject">dbObject</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-str"></span><span class="src-str">"</span><span class="src-id">INSERT</span> <span class="src-id">INTO</span> <span class="src-id">users_access_levels</span> ( <span class="src-id">userid</span>, <span class="src-id">access_level_id</span> ) <span class="src-id">VALUES</span> ( '</span>{<span class="src-var">$userid</span><span class="src-str"></span><span class="src-sym">}</span>', '</span>{<span class="src-var">$access_level_id</span><span class="src-str"></span><span class="src-sym">}</span>' )<span class="src-str">"</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a187"></a>&nbsp;</li>
<li><a name="a188"></a></span><span class="src-str">        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$SQLq</span><span class="src-sym">)</span></span></li>
<li><a name="a189"></a></span><span class="src-str">            <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a190"></a></span><span class="src-str">        <span class="src-key">else</span></span></li>
<li><a name="a191"></a></span><span class="src-str">            <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a192"></a></span><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a193"></a>&nbsp;</li>
<li><a name="a194"></a></span><span class="src-str">    /**</span></li>
<li><a name="a195"></a></span><span class="src-str">     * Clear access levels.</span></li>
<li><a name="a196"></a></span><span class="src-str">     *</span></li>
<li><a name="a197"></a></span><span class="src-str">     * @param $userid int - User's unique ID.</span></li>
<li><a name="a198"></a></span><span class="src-str">     * @return bool</span></li>
<li><a name="a199"></a></span><span class="src-str">     */</span></li>
<li><a name="a200"></a>&nbsp;</li>
<li><a name="a201"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">clearAccessLevels</span><span class="src-sym">(</span><span class="src-var">$userid</span><span class="src-sym">)</span></span></li>
<li><a name="a202"></a></span><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a203"></a></span><span class="src-str">        <span class="src-var">$userid</span> = (int)<span class="src-var">$userid</span><span class="src-sym">;</span></span></li>
<li><a name="a204"></a></span><span class="src-str">        <span class="src-var">$SQLq</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$dbObject">dbObject</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-str"></span><span class="src-str">"</span><span class="src-id">DELETE</span> <span class="src-id">FROM</span> <span class="src-id">users_access_levels</span> <span class="src-id">WHERE</span> <span class="src-id">userid</span>='</span>{<span class="src-var">$userid</span><span class="src-str"></span><span class="src-sym">}</span>'<span class="src-str">"</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a205"></a></span><span class="src-str">        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$SQLq</span><span class="src-sym">)</span></span></li>
<li><a name="a206"></a></span><span class="src-str">            <span class="src-comm">//return(0);</span></span></li>
<li><a name="a207"></a></span><span class="src-str">            <span class="src-key">return</span><span class="src-sym">(</span><span class="src-id">mysql_errno</span><span class="src-sym">(</span><span class="src-sym">)</span>.<span class="src-str">': '</span>.<span class="src-id">mysql_error</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></span></li>
<li><a name="a208"></a></span><span class="src-str">        <span class="src-key">else</span></span></li>
<li><a name="a209"></a></span><span class="src-str">        echo <span class="src-str">&quot;Success&quot;</span><span class="src-sym">;</span></span></li>
<li><a name="a210"></a></span><span class="src-str">            <span class="src-comm">//return(mysql_errno().': '.mysql_error());</span></span></li>
<li><a name="a211"></a></span><span class="src-str">            <span class="src-comm">//return(1);</span></span></li>
<li><a name="a212"></a></span><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a213"></a></span><span class="src-str">    </span></li>
<li><a name="a214"></a></span><span class="src-str">    /**</span></li>
<li><a name="a215"></a></span><span class="src-str">     * Get access levels.</span></li>
<li><a name="a216"></a></span><span class="src-str">     *</span></li>
<li><a name="a217"></a></span><span class="src-str">     * @param $userid int - User's unique ID.</span></li>
<li><a name="a218"></a></span><span class="src-str">     * @return bool</span></li>
<li><a name="a219"></a></span><span class="src-str">     */</span></li>
<li><a name="a220"></a>&nbsp;</li>
<li><a name="a221"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">getAccessLevels</span><span class="src-sym">(</span><span class="src-var">$userid</span><span class="src-sym">)</span></span></li>
<li><a name="a222"></a></span><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a223"></a></span><span class="src-str">        <span class="src-var">$userid</span> = (int)<span class="src-var">$userid</span><span class="src-sym">;</span></span></li>
<li><a name="a224"></a></span><span class="src-str">        <span class="src-var">$SQLq</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$dbObject">dbObject</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-str"></span><span class="src-str">"</span><span class="src-id">DELETE</span> <span class="src-id">FROM</span> <span class="src-id">users_access_levels</span> <span class="src-id">WHERE</span> <span class="src-id">userid</span>='</span>{<span class="src-var">$userid</span><span class="src-str"></span><span class="src-sym">}</span>'<span class="src-str">"</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a225"></a></span><span class="src-str">        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$SQLq</span><span class="src-sym">)</span></span></li>
<li><a name="a226"></a></span><span class="src-str">            <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a227"></a></span><span class="src-str">        <span class="src-key">else</span></span></li>
<li><a name="a228"></a></span><span class="src-str">            <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a229"></a></span><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a230"></a>&nbsp;</li>
<li><a name="a231"></a></span><span class="src-str">    /**</span></li>
<li><a name="a232"></a></span><span class="src-str">     * Remove all sessions from the current user.</span></li>
<li><a name="a233"></a></span><span class="src-str">     *</span></li>
<li><a name="a234"></a></span><span class="src-str">     * @param $user string - User's username.</span></li>
<li><a name="a235"></a></span><span class="src-str">     * @param $pass string - User's password.</span></li>
<li><a name="a236"></a></span><span class="src-str">     * @return bool</span></li>
<li><a name="a237"></a></span><span class="src-str">     */</span></li>
<li><a name="a238"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">logout</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a239"></a></span><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a240"></a></span><span class="src-str">        <span class="src-comm">//foreach ($_SESSION as $session)</span></span></li>
<li><a name="a241"></a></span><span class="src-str">        <span class="src-comm">//{</span></span></li>
<li><a name="a242"></a></span><span class="src-str">        <span class="src-comm">//    return $this-&gt;errorObject-&gt;logError('Logout ('.date(&quot;m-d-Y&quot;).'): ', $session);</span></span></li>
<li><a name="a243"></a></span><span class="src-str">        <span class="src-comm">//}</span></span></li>
<li><a name="a244"></a></span><span class="src-str">        <span class="src-comm">//session_unset();</span></span></li>
<li><a name="a245"></a></span><span class="src-str">        <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$_SESSION</span> <span class="src-key">as</span> <span class="src-var">$session</span><span class="src-sym">)</span></span></li>
<li><a name="a246"></a></span><span class="src-str">        <span class="src-sym">{</span></span></li>
<li><a name="a247"></a></span><span class="src-str">            unset<span class="src-sym">(</span><span class="src-var">$session</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a248"></a></span><span class="src-str">        <span class="src-sym">}</span></span></li>
<li><a name="a249"></a></span><span class="src-str">        </span></li>
<li><a name="a250"></a></span><span class="src-str">        <span class="src-id">session_destroy</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a251"></a></span><span class="src-str">        <span class="src-comm">//header(&quot;location:index.php?user=&amp;page=login&quot;);</span></span></li>
<li><a name="a252"></a></span><span class="src-str">        <span class="src-id">header</span><span class="src-sym">(</span><span class="src-str">&quot;location:/managedNOC/index.php?user=&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a253"></a></span><span class="src-str">        <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a254"></a></span><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a255"></a>&nbsp;</li>
<li><a name="a256"></a></span><span class="src-str">    <span class="src-comm">// Salt Generator</span></span></li>
<li><a name="a257"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">generate_salt</span><span class="src-sym">(</span><span class="src-sym">)</span></span></li>
<li><a name="a258"></a></span><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a259"></a></span><span class="src-str">     <span class="src-comm">// Declare $salt</span></span></li>
<li><a name="a260"></a></span><span class="src-str">     <span class="src-var">$salt</span> = <span class="src-str">''</span><span class="src-sym">;</span></span></li>
<li><a name="a261"></a>&nbsp;</li>
<li><a name="a262"></a></span><span class="src-str">     <span class="src-comm">// And create it with random chars</span></span></li>
<li><a name="a263"></a></span><span class="src-str">     <span class="src-key">for</span> <span class="src-sym">(</span><span class="src-var">$i</span> = <span class="src-num">0</span><span class="src-sym">;</span> <span class="src-var">$i</span> < <span class="src-num">3</span><span class="src-sym">;</span> <span class="src-var">$i</span>++<span class="src-sym">)</span></span></li>
<li><a name="a264"></a></span><span class="src-str">     <span class="src-sym">{</span></span></li>
<li><a name="a265"></a></span><span class="src-str">          <span class="src-var">$salt</span> .= <span class="src-id">chr</span><span class="src-sym">(</span><span class="src-id">rand</span><span class="src-sym">(</span><span class="src-num">35</span><span class="src-sym">,</span> <span class="src-num">126</span><span class="src-sym">))</span><span class="src-sym">;</span></span></li>
<li><a name="a266"></a></span><span class="src-str">     <span class="src-sym">}</span></span></li>
<li><a name="a267"></a></span><span class="src-str">          <span class="src-key">return</span> <span class="src-var">$salt</span><span class="src-sym">;</span></span></li>
<li><a name="a268"></a></span><span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a269"></a>&nbsp;</li>
<li><a name="a270"></a></span><span class="src-str">    /**</span></li>
<li><a name="a271"></a></span><span class="src-str">     * Retrieves the signature information for a given user.</span></li>
<li><a name="a272"></a></span><span class="src-str">     *</span></li>
<li><a name="a273"></a></span><span class="src-str">     * @param $user string - User's username.</span></li>
<li><a name="a274"></a></span><span class="src-str">     * @return $usersig</span></li>
<li><a name="a275"></a></span><span class="src-str">     */</span></li>
<li><a name="a276"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">getUserSignature</span><span class="src-sym">(</span><span class="src-var">$email1</span><span class="src-sym">)</span></span></li>
<li><a name="a277"></a></span><span class="src-str">    <span class="src-sym">{</span></span></li>
<li><a name="a278"></a></span><span class="src-str">        <span class="src-var">$SQLq</span> = <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$dbObject">dbObject</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-str"></span><span class="src-str">"</span><span class="src-id">SELECT</span> <span class="src-id">sig</span> <span class="src-id">FROM</span> <span class="src-id">users</span> <span class="src-id">WHERE</span> <span class="src-id">email1</span> = '</span>{<span class="src-var">$email1</span><span class="src-str"></span><span class="src-sym">}</span>' <span class="src-id">LIMIT</span> 1<span class="src-str">"</span><span class="src-sym">,</span> <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></span></li>
<li><a name="a279"></a>&nbsp;</li>
<li><a name="a280"></a></span><span class="src-str">        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$SQLq</span><span class="src-sym">[</span><span class="src-str">'sig'</span><span class="src-sym">]</span><span class="src-sym">))</span> <span class="src-sym">{</span></span></li>
<li><a name="a281"></a></span><span class="src-str">            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#methodverifyUser">verifyUser</a><span class="src-sym">(</span><span class="src-sym">@</span><span class="src-var">$_SESSION</span><span class="src-sym">[</span><span class="src-str">'username'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-sym">@</span><span class="src-var">$_SESSION</span><span class="src-sym">[</span><span class="src-str">'password'</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-str"></span><span class="src-sym">{</span> </span></li>
<li><a name="a282"></a></span><span class="src-str">                <span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$usersig">usersig</a> = <span class="src-var">$SQLq</span><span class="src-sym">[</span><span class="src-str">'sig'</span><span class="src-sym">]</span><span class="src-sym">; </span><span class="src-key">return</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$usersig">usersig</a> = <span class="src-id">explode</span><span class="src-sym">(</span><span class="src-str">'&lt;br \&gt;'</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../default/userObject.html#var$usersig">usersig</a><span class="src-sym">))</span><span class="src-sym">; </span><span class="src-str"></span><span class="src-sym">}</span></span></li>
<li><a name="a283"></a></span><span class="src-str">            <span class="src-key">else</span> <span class="src-sym">{</span> <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span> <span class="src-sym">}</span></span></li>
<li><a name="a284"></a></span><span class="src-str">        <span class="src-sym">}</span> <span class="src-key">else</span> <span class="src-sym">{</span> <span class="src-key">return</span><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span> <span class="src-sym">}</span></span></li>
<li><a name="a285"></a></span><span class="src-str">        </span></li>
<li><a name="a286"></a></span><span class="src-str">    <span class="src-sym">}</span></span></li>
<li><a name="a287"></a></span><span class="src-str">    </span></li>
<li><a name="a288"></a></span><span class="src-str">   /**</span></li>
<li><a name="a289"></a></span><span class="src-str">     * Retrieves the database signature information for a given user.</span></li>
<li><a name="a290"></a></span><span class="src-str">     *</span></li>
<li><a name="a291"></a></span><span class="src-str">     * @param $user string - User's username.</span></li>
<li><a name="a292"></a></span><span class="src-str">     * @return $usersig</span></li>
<li><a name="a293"></a></span><span class="src-str">     */ </span></li>
<li><a name="a294"></a></span><span class="src-str">   </span></li>
<li><a name="a295"></a></span><span class="src-str">   <span class="src-key">function</span> <span class="src-id">outputUserSignature</span><span class="src-sym">(</span><span class="src-var">$usersig_array</span><span class="src-sym">)</span> <span class="src-sym">{</span></span></li>
<li><a name="a296"></a></span><span class="src-str">           <span class="src-key">foreach</span> <span class="src-sym">(</span><span class="src-var">$usersig_array</span> <span class="src-key">as</span> <span class="src-var">$key</span>=&gt;<span class="src-var">$usr_arr</span><span class="src-sym">)</span> <span class="src-sym">{</span></span></li>
<li><a name="a297"></a></span><span class="src-str">            <span class="src-comm">// Not Done</span></span></li>
<li><a name="a298"></a></span><span class="src-str">           <span class="src-sym">}</span></span></li>
<li><a name="a299"></a></span><span class="src-str">   <span class="src-sym">}</span></span></li>
<li><a name="a300"></a>&nbsp;</li>
<li><a name="a301"></a></span><span class="src-str">    <span class="src-key">function</span> <span class="src-id">__destruct</span><span class="src-sym">(</span><span class="src-sym">)</span> <span class="src-sym">{</span> <span class="src-sym">}</span></span></li>
<li><a name="a302"></a>&nbsp;</li>
<li><a name="a303"></a></span><span class="src-str"><span class="src-sym">}</span></span></li>
<li><a name="a304"></a>&nbsp;</li>
</ol></pre>
</div>
	<p class="notes" id="credit">
		Documentation generated on Mon, 19 Jul 2010 20:32:24 -0500 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.3.0RC3</a>
	</p>
	</body>
</html>