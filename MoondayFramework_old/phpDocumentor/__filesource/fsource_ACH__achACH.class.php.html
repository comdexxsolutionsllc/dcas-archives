<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>File Source for ACH.class.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
						<h1>Source for file ACH.class.php</h1>
<p>Documentation is available at <a href="../ACH/_ach_ACH_class_php.html">ACH.class.php</a></p>
<div class="src-code">
<pre><ol><li><a name="a1"></a><span class="src-php">&lt;?php</span></li>
<li><a name="a2"></a>&nbsp;</li>
<li><a name="a3"></a><span class="src-doc">/**</span></li>
<li><a name="a4"></a><span class="src-doc">* </span><span class="src-doc-coretag">@package</span><span class="src-doc"> ACH</span></li>
<li><a name="a5"></a><span class="src-doc">* </span><span class="src-doc-coretag">@author</span><span class="src-doc"> Joshua Abbott, WiseGene Project (NKommunikation)</span></li>
<li><a name="a6"></a><span class="src-doc">* </span><span class="src-doc-coretag">@copyright</span><span class="src-doc"> (C) 2006 NKommunikation. All Rights Reserved.</span></li>
<li><a name="a7"></a><span class="src-doc">* </span><span class="src-doc-tag">@desc</span><span class="src-doc">            Extension of ACH_core.class.php</span></li>
<li><a name="a8"></a><span class="src-doc">* </span><span class="src-doc-coretag">@uses</span></li>
<li><a name="a9"></a><span class="src-doc">* </span><span class="src-doc-coretag">@example</span></li>
<li><a name="a10"></a><span class="src-doc">* </span><span class="src-doc-tag">@files</span></li>
<li><a name="a11"></a><span class="src-doc">*/</span></li>
<li><a name="a12"></a>&nbsp;</li>
<li><a name="a13"></a><span class="src-key">class </span><a href="../ACH/ACH.html">ACH</a> <span class="src-key">extends </span><a href="../ACH_core/ACH_core.html#methodACH_core">ACH_core</a> <span class="src-sym">{</span></li>
<li><a name="a14"></a>    </li>
<li><a name="a15"></a>    <span class="src-comm">//////////////////   EDIT BELOW</span></li>
<li><a name="a16"></a>    </li>
<li><a name="a15"></a>    </li>
<li><a name="a16"></a>    </li>
<li><a name="a17"></a>    <span class="src-key">var </span><a href="../ACH/ACH.html#var$debug">$debug</a>        = <span class="src-id">TRUE</span><span class="src-sym">;     </span><span class="src-comm">// set to TRUE to print out the error email instead of sending it</span></li>
<li><a name="a17"></a>    </li>
<li><a name="a18"></a>    <span class="src-key">var </span><a href="../ACH/ACH.html#var$errorEmail">$errorEmail</a>     = <span class="src-str">'you@yourdomain.com'</span><span class="src-sym">;     </span><span class="src-comm">// address to send errors.</span></li>
<li><a name="a19"></a>                                <span class="src-comm">// separate multiples by commas</span></li>
<li><a name="a19"></a>    </li>
<li><a name="a20"></a>    <span class="src-key">var </span><a href="../ACH/ACH.html#var$adminEmail">$adminEmail</a>        = <span class="src-str">'paymentsupport@yourdomain.com'</span><span class="src-sym">; </span><span class="src-comm">// email for end user mailto for payment 'help'</span></li>
<li><a name="a20"></a>    </li>
<li><a name="a21"></a>    <span class="src-key">var </span><a href="../ACH/ACH.html#var$live">$live</a>        = <span class="src-id">FALSE</span><span class="src-sym">;     </span><span class="src-comm">// change to TRUE to go live</span></li>
<li><a name="a21"></a>    </li>
<li><a name="a22"></a>    <span class="src-key">var </span><a href="../ACH/ACH.html#var$liveurl">$liveurl</a>         = <span class="src-str">''</span><span class="src-sym">;     </span><span class="src-comm">// 'LIVE' url - contact ACH Direct</span></li>
<li><a name="a22"></a>    </li>
<li><a name="a23"></a>    <span class="src-key">var </span><a href="../ACH/ACH.html#var$testurl">$testurl</a>         = <span class="src-str">''</span><span class="src-sym">;     </span><span class="src-comm">// 'TEST' url - contact ACH Direct</span></li>
<li><a name="a23"></a>    </li>
<li><a name="a24"></a>    <span class="src-key">var </span><a href="../ACH/ACH.html#var$numRetries">$numRetries</a>     = <span class="src-str">'2'</span><span class="src-sym">;     </span><span class="src-comm">// Number of times to retry the connection upon </span></li>
<li><a name="a25"></a>                               <span class="src-comm">// curl_exec() failure (just in case).  Set to '0' for only one attempt</span></li>
<li><a name="a26"></a>        </li>
<li><a name="a25"></a>    </li>
<li><a name="a26"></a>        </li>
<li><a name="a27"></a>    <span class="src-key">var </span><a href="../ACH/ACH.html#var$error_codes">$error_codes</a> = <span class="src-key">array</span><span class="src-sym">( </span></li>
<li><a name="a28"></a>        <span class="src-str">'U01'</span><span class="src-sym">,         </span><span class="src-str">'U02'</span><span class="src-sym">,     </span><span class="src-comm">// pg_reponse_code 's that will trigger an email to $errorEmail above</span></li>
<li><a name="a28"></a>        </li>
<li><a name="a29"></a>        <span class="src-str">'U03'</span><span class="src-sym">,         </span><span class="src-str">'U04'</span><span class="src-sym">,     </span><span class="src-comm">// most of these will probably never occur but it doesn't hurt.</span></li>
<li><a name="a29"></a>        </li>
<li><a name="a30"></a>        <span class="src-str">'U08'</span><span class="src-sym">,         </span><span class="src-str">'U09'</span><span class="src-sym">, </span></li>
<li><a name="a31"></a>        <span class="src-str">'U11'</span><span class="src-sym">,         </span><span class="src-str">'U12'</span><span class="src-sym">, </span></li>
<li><a name="a32"></a>        <span class="src-str">'U13'</span><span class="src-sym">,         </span><span class="src-str">'U14'</span><span class="src-sym">, </span></li>
<li><a name="a33"></a>        <span class="src-str">'U18'</span><span class="src-sym">,         </span></li>
<li><a name="a34"></a>        <span class="src-str">'U21'</span><span class="src-sym">,         </span><span class="src-str">'U22'</span><span class="src-sym">, </span></li>
<li><a name="a35"></a>        <span class="src-str">'U23'</span><span class="src-sym">,         </span><span class="src-str">'U51'</span><span class="src-sym">, </span></li>
<li><a name="a36"></a>        <span class="src-str">'U52'</span><span class="src-sym">,         </span><span class="src-str">'U53'</span><span class="src-sym">, </span></li>
<li><a name="a37"></a>        <span class="src-str">'U54'</span><span class="src-sym">,         </span><span class="src-str">'U83'</span><span class="src-sym">, </span></li>
<li><a name="a38"></a>        <span class="src-str">'U84'</span><span class="src-sym">,         </span><span class="src-str">'U85'</span><span class="src-sym">, </span></li>
<li><a name="a39"></a>        <span class="src-str">'U86'</span><span class="src-sym">,        </span><span class="src-str">'F01'</span><span class="src-sym">,</span></li>
<li><a name="a40"></a>        <span class="src-str">'F03'</span><span class="src-sym">,        </span><span class="src-str">'F04'</span><span class="src-sym">,</span></li>
<li><a name="a41"></a>        <span class="src-str">'F05'</span><span class="src-sym">,        </span><span class="src-str">'F07'</span><span class="src-sym">,</span></li>
<li><a name="a42"></a>        <span class="src-str">'E10'</span><span class="src-sym">,        </span><span class="src-str">'E20'</span><span class="src-sym">,</span></li>
<li><a name="a43"></a>        <span class="src-str">'E90'</span><span class="src-sym">,        </span><span class="src-str">'E99'</span></li>
<li><a name="a44"></a>    <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a45"></a>    </li>
<li><a name="a46"></a>    <span class="src-comm">//////////////////   END EDITING</span></li>
<li><a name="a47"></a>    </li>
<li><a name="a46"></a>    </li>
<li><a name="a47"></a>    </li>
<li><a name="a48"></a>    <span class="src-key">var </span><a href="../ACH/ACH.html#var$displayText">$displayText</a>    = <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a49"></a>    <span class="src-key">var </span><a href="../ACH/ACH.html#var$trans">$trans</a>         = <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a50"></a>    </li>
<li><a name="a51"></a>    <span class="src-comm">// $msg (assoc array) = $HTTP_POST_VARS or $_POST for 4.1+ or $_GET if you're so inclined or any associative array</span></li>
<li><a name="a52"></a>    <span class="src-comm">// $exceptions (array) = variable names to remove from $msg</span></li>
<li><a name="a52"></a>    </li>
<li><a name="a53"></a>    <span class="src-key">function </span><a href="../ACH/ACH.html#methodACH">ACH</a><span class="src-sym">(</span><span class="src-var">$user</span><span class="src-sym">,</span><span class="src-var">$pass</span><span class="src-sym">,</span><span class="src-var">$msg</span>=<span class="src-str">''</span><span class="src-sym">,</span><span class="src-var">$exceptions</span>=<span class="src-str">''</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a54"></a>        <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$live">live</a><span class="src-sym">) </span>? <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$posturl">posturl</a>=<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$liveurl">liveurl</a> : <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$posturl">posturl</a>=<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$testurl">testurl</a><span class="src-sym">;</span></li>
<li><a name="a55"></a>&nbsp;</li>
<li><a name="a56"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#methodACH_core">ACH_core</a><span class="src-sym">(</span><span class="src-var">$user</span><span class="src-sym">,</span><span class="src-var">$pass</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a57"></a>        </li>
<li><a name="a58"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$msg</span><span class="src-sym">))</span><span class="src-sym">{</span></li>
<li><a name="a59"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$msg</span><span class="src-sym">))</span><span class="src-sym">{</span></li>
<li><a name="a60"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#methodsetFields">setFields</a><span class="src-sym">(</span><span class="src-var">$msg</span><span class="src-sym">,</span><span class="src-var">$exceptions</span><span class="src-sym">))</span><span class="src-sym">{</span></li>
<li><a name="a61"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#methodsetMessage">setMessage</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">{</span></li>
<li><a name="a62"></a>                        do <span class="src-sym">{</span></li>
<li><a name="a63"></a>                            <span class="src-var">$response </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#methodrunTransaction">runTransaction</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a64"></a>                            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$numRetries">numRetries</a>--<span class="src-sym">;</span></li>
<li><a name="a65"></a>                        <span class="src-sym">} </span><span class="src-key">while </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$response </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$numRetries">numRetries</a> &gt;= <span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a66"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$response</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a67"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#methodparseResponse">parseResponse</a><span class="src-sym">(</span><span class="src-var">$response</span><span class="src-sym">))</span><span class="src-sym">{</span></li>
<li><a name="a68"></a>                                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#methodsetTransactionDescription">setTransactionDescription</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">{</span></li>
<li><a name="a69"></a>                                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#methodchkError">chkError</a><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-comm">// NO SCRIPT ERROR BUT MAY BE ACH ERROR</span></li>
<li><a name="a70"></a>                                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#methodchkError">chkError</a><span class="src-sym">(</span><span class="src-num">5</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">} </span><span class="src-comm">// ERROR IN setTransactionDescription()</span></li>
<li><a name="a71"></a>                            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#methodchkError">chkError</a><span class="src-sym">(</span><span class="src-num">4</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">} </span><span class="src-comm">// ERROR IN parseResponse()</span></li>
<li><a name="a72"></a>                        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#methodchkError">chkError</a><span class="src-sym">(</span><span class="src-num">3</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">} </span><span class="src-comm">// ERROR IN runTransaction()</span></li>
<li><a name="a73"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#methodchkError">chkError</a><span class="src-sym">(</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">} </span><span class="src-comm">// ERROR IN setMessage()</span></li>
<li><a name="a74"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#methodchkError">chkError</a><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">} </span><span class="src-comm">// ERROR IN setFields()</span></li>
<li><a name="a75"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#methodchkError">chkError</a><span class="src-sym">(</span><span class="src-num">7</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">} </span><span class="src-comm">// $msg exists but is not an array</span></li>
<li><a name="a76"></a>        <span class="src-sym">}</span></li>
<li><a name="a77"></a>    <span class="src-sym">}</span></li>
<li><a name="a78"></a>    </li>
<li><a name="a79"></a>    <span class="src-comm">// $tagleft and $tagright are associative arrays of links or whatever.  See ach_test.php</span></li>
<li><a name="a79"></a>    </li>
<li><a name="a80"></a>    <span class="src-key">function </span><a href="../ACH/ACH.html#methodgetDisplayText">getDisplayText</a><span class="src-sym">(</span><span class="src-var">$tagleft</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$tagright</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a81"></a>        <span class="src-var">$hdr </span>= <span class="src-str">'&lt;table class=ACH_table&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a82"></a>        <span class="src-var">$bdy </span>= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;Date:&lt;/td&gt;&lt;td class=ACH_val&gt;'</span>.<a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'m/d/Y H:i:s T'</span><span class="src-sym">)</span>.<span class="src-str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a83"></a>        <span class="src-var">$ftr </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a84"></a>        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;First Name:&lt;/td&gt;&lt;td class=ACH_val&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'ecom_billto_postal_name_first'</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a85"></a>        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;Last Name:&lt;/td&gt;&lt;td class=ACH_val&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'ecom_billto_postal_name_last'</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a86"></a>        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;Amount:&lt;/td&gt;&lt;td class=ACH_val&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_total_amount'</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a87"></a>        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;Transaction Type:&lt;/td&gt;&lt;td class=ACH_val&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_transaction_type'</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a88"></a>        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;Payment ID:&lt;/td&gt;&lt;td class=ACH_val&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'ecom_consumerorderid'</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a89"></a>        <span class="src-comm">//$bdy .= '&lt;tr&gt;&lt;td class=ACH_label&gt;RID:&lt;/td&gt;&lt;td class=ACH_val&gt;'.$this-&gt;r_properties['pg_consumer_id'].'&lt;/td&gt;&lt;/tr&gt;';</span></li>
<li><a name="a90"></a>        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;Trace Number:&lt;/td&gt;&lt;td class=ACH_val&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_trace_number'</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a91"></a>        <span class="src-key">switch </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_response_type'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a92"></a>            <span class="src-key">case </span><span class="src-str">'A'</span>:</li>
<li><a name="a93"></a>                <span class="src-var">$hdr </span>.= <span class="src-str">'&lt;tr&gt;&lt;td colspan=2 class=ACH_hdr&gt;Transaction Approved&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a94"></a>                <span class="src-var">$hdr </span>.= <span class="src-str">'&lt;tr&gt;&lt;td colspan=2 class=ACH_spc&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a95"></a>                <span class="src-key">switch </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_response_code'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a96"></a>                    <span class="src-key">case </span><span class="src-str">'A01'</span>:                    </li>
<li><a name="a97"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Your payment has been submitted and pre-authorized for approval.  However, the transaction may require up to 4 business days to process and could end in declined status.  What this means is if your account does not contain sufficient funds when the EFT transaction occurs, this payment will be declined and NSF and late fees may apply.&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a98"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a99"></a>                    <span class="src-key">default</span>:</li>
<li><a name="a100"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Unrecognized response code (A01)&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a101"></a>                <span class="src-sym">}</span></li>
<li><a name="a102"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a103"></a>            <span class="src-key">case </span><span class="src-str">'D'</span>:</li>
<li><a name="a104"></a>                <span class="src-var">$hdr </span>.= <span class="src-str">'&lt;tr&gt;&lt;td colspan=2 class=ACH_hdr&gt;Transaction DECLINED&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a105"></a>                <span class="src-var">$hdr </span>.= <span class="src-str">'&lt;tr&gt;&lt;td colspan=2 class=ACH_spc&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a106"></a>                <span class="src-key">switch </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_response_code'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a107"></a>                    <span class="src-key">case </span><span class="src-str">'U01'</span>: <span class="src-key">case </span><span class="src-str">'U03'</span>: <span class="src-key">case </span><span class="src-str">'U04'</span>: <span class="src-key">case </span><span class="src-str">'U08'</span>: <span class="src-key">case </span><span class="src-str">'U09'</span>: <span class="src-key">case </span><span class="src-str">'U11'</span>: <span class="src-key">case </span><span class="src-str">'U12'</span>: <span class="src-key">case </span><span class="src-str">'U13'</span>: <span class="src-key">case </span><span class="src-str">'U14'</span>: <span class="src-key">case </span><span class="src-str">'U18'</span>: <span class="src-key">case </span><span class="src-str">'U20'</span>: <span class="src-key">case </span><span class="src-str">'U21'</span>: <span class="src-key">case </span><span class="src-str">'U22'</span>: <span class="src-key">case </span><span class="src-str">'U23'</span>: <span class="src-key">case </span><span class="src-str">'U51'</span>: <span class="src-key">case </span><span class="src-str">'U52'</span>: <span class="src-key">case </span><span class="src-str">'U53'</span>: <span class="src-key">case </span><span class="src-str">'U54'</span>:                    </li>
<li><a name="a108"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Your transaction has been declined due to unusual circumstances.  Your account has not been charged.  Technical support has been contacted automatically as a result of this error.  The problem may be fixed shortly but please allow up to 24 hours to resolve the issue.  We\'re sorry for the inconvenience.  Please attempt your transaction again soon or contact your community manager to arrange for another payment option.  Thank you.&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a109"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a110"></a>                    <span class="src-key">case </span><span class="src-str">'U02'</span>:                    </li>
<li><a name="a111"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Your payment has been declined because your account has been flagged as a \'known bad\' account by the ACH processor.  Your account has not been charged.  If you believe this is an error please contact &lt;a href=mailto:\''</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$adminEmail">adminEmail</a>.<span class="src-str">'\'&gt;technical support&lt;/a&gt;.&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a112"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a113"></a>                    <span class="src-key">case </span><span class="src-str">'U05'</span>: <span class="src-key">case </span><span class="src-str">'U06'</span>: <span class="src-key">case </span><span class="src-str">'U07'</span>:                    </li>
<li><a name="a114"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Your payment has been declined due to an AVS check failure.  Your account has not been charged.  AVS is a service that checks your account number against other information about your account like your zip code or area code.&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a115"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a116"></a>                    <span class="src-key">case </span><span class="src-str">'U10'</span>:                    </li>
<li><a name="a117"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Your payment has been declined because it has been determined to be a duplicate transaction.  Your account has not been charged for this transaction.  This probably means that you submitted a transaction a few moments ago using the same account information or you simply double-clicked the process payment button.  Please click here to view your &lt;a href=history.php&gt;payment history&lt;/a&gt;.&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a118"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a119"></a>                    <span class="src-key">case </span><span class="src-str">'U19'</span>:</li>
<li><a name="a120"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Your payment has been declined because the bank routing code you have entered is invalid.  Your account has not been charged for this transaction.&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a121"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a122"></a>                    <span class="src-key">case </span><span class="src-str">'U80'</span>: <span class="src-key">case </span><span class="src-str">'U83'</span>: <span class="src-key">case </span><span class="src-str">'U86'</span>:                    </li>
<li><a name="a123"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Your payment has been declined due to an authorization failure.  This means that either the routing code you have entered doesn\'t exist or the account you have entered doesn\'t exist, isn\'t debitable or is not in good standing (e.g. in a NSF state).&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a124"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a125"></a>                    <span class="src-key">case </span><span class="src-str">'U84'</span>: <span class="src-key">case </span><span class="src-str">'U85'</span>:                    </li>
<li><a name="a126"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Your payment has been declined due to an authorization system failure.  This may mean that the authorizer or preauthorizer is currently down or is too busy to process the request.  Technical support has been contacted automatically as a result of this error in case this failure is not temporary.  However, this problem is most likely temporary so it is recommended that you attempt to processes this payment again in a few minutes.  If you continue to experience problems, please contact your community manager to arrange for another payment option.  Thank you.&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a127"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a128"></a>                    <span class="src-key">default</span>:</li>
<li><a name="a129"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Unrecognized response code ()&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a130"></a>                <span class="src-sym">}</span></li>
<li><a name="a131"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a132"></a>            <span class="src-key">case </span><span class="src-str">'E'</span>:</li>
<li><a name="a133"></a>                <span class="src-var">$hdr </span>.= <span class="src-str">'&lt;tr&gt;&lt;td colspan=2 class=ACH_hdr&gt;Transaction ERROR&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a134"></a>                <span class="src-var">$hdr </span>.= <span class="src-str">'&lt;tr&gt;&lt;td colspan=2 class=ACH_spc&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a135"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$histnum</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$ftr</span>.=<span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">a</span> <span class="src-id">href</span>=<span class="src-id">javascript</span>:<span class="src-id">history</span>.<span class="src-id">go</span>(-<span class="src-var">$histnum</span>)&gt;&amp;<span class="src-id">lt</span>;&amp;<span class="src-id">lt</span>; <span class="src-id">Try</span> <span class="src-id">Again</span>&lt;/<span class="src-id">a</span>&gt;&lt;/<span class="src-id">td</span>&gt;</span><span class="src-str">&quot;</span><span class="src-sym">;</span><span class="src-sym">}</span></li>
<li><a name="a136"></a>                <span class="src-key">switch </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_response_code'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a137"></a>                    <span class="src-key">case </span><span class="src-str">'F01'</span>: <span class="src-key">case </span><span class="src-str">'F03'</span>: <span class="src-key">case </span><span class="src-str">'F04'</span>: <span class="src-key">case </span><span class="src-str">'F05'</span>: <span class="src-key">case </span><span class="src-str">'F07'</span>:</li>
<li><a name="a138"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Your payment has failed due to a formatting error.  Technical support has been contacted automatically as a result of this error.  If you continue to experience problems, please contact your community manager to arrange for another payment option.  Thank you.&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a139"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a140"></a>                    <span class="src-key">case </span><span class="src-str">'E10'</span>: <span class="src-key">case </span><span class="src-str">'E20'</span>: <span class="src-key">case </span><span class="src-str">'E90'</span>: <span class="src-key">case </span><span class="src-str">'E99'</span>:</li>
<li><a name="a141"></a>                        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Your payment has failed due to an unspecified error.  Technical support has been contacted automatically as a result of this error.  If you continue to experience problems, please contact your community manager to arrange for another payment option.  Thank you.&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a142"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a143"></a>                <span class="src-sym">}</span></li>
<li><a name="a144"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a145"></a>            <span class="src-key">default</span>:</li>
<li><a name="a146"></a>                <span class="src-var">$hdr </span>.= <span class="src-str">'&lt;tr&gt;&lt;td colspan=2 class=ACH_hdr&gt;Transaction ERROR&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a147"></a>                <span class="src-var">$hdr </span>.= <span class="src-str">'&lt;tr&gt;&lt;td colspan=2 class=ACH_spc&gt;&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a148"></a>                <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;NOTES:&lt;/td&gt;&lt;td class=ACH_val&gt;Unrecognized Response Type.'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_response_description'</span><span class="src-sym">]</span>.<span class="src-str">' Tech support has been notified&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a149"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#methodchkError">chkError</a><span class="src-sym">(</span><span class="src-num">6</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a150"></a>        <span class="src-sym">}</span></li>
<li><a name="a151"></a>        <span class="src-var">$bdy </span>.= <span class="src-str">'&lt;tr&gt;&lt;td class=ACH_label&gt;&amp;nbsp;&lt;/td&gt;&lt;td class=ACH_val&gt;Please &lt;a href=javascript:print()&gt;print&lt;/a&gt; this page for your records&lt;/td&gt;&lt;/tr&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a152"></a>        <span class="src-var">$ftr</span>.=<span class="src-str">&quot;&lt;tr&gt;&lt;td colspan=2&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a153"></a>        <span class="src-var">$ftr</span>.=<span class="src-str">&quot;&lt;table class=ACH_ftr_table&gt;&lt;tr&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a154"></a>        <span class="src-var">$ftr</span>.=<span class="src-str">&quot;&lt;td class=ACH_ftr_left&gt;&quot;</span>.<span class="src-var">$tagleft</span><span class="src-sym">[</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_response_type'</span><span class="src-sym">]]</span>.<span class="src-str">&quot;&lt;/td&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a155"></a>        <span class="src-var">$ftr</span>.=<span class="src-str">&quot;&lt;td class=ACH_ftr_right&gt;&quot;</span>.<span class="src-var">$tagright</span><span class="src-sym">[</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_response_type'</span><span class="src-sym">]]</span>.<span class="src-str">&quot;&lt;/td&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a156"></a>        <span class="src-var">$ftr</span>.=<span class="src-str">&quot;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a157"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$displayText">displayText</a>=<span class="src-var">$hdr</span>.<span class="src-var">$bdy</span>.<span class="src-var">$ftr</span><span class="src-sym">;</span></li>
<li><a name="a158"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$displayText">displayText</a><span class="src-sym">;</span></li>
<li><a name="a159"></a>    <span class="src-sym">}</span></li>
<li><a name="a160"></a>    </li>
<li><a name="a161"></a>    <span class="src-comm">// ERROR HANDLER - prints to screen in debug mode (even if there isn't an error).  </span></li>
<li><a name="a162"></a>    <span class="src-comm">// With debug off - sends email upon script error or based on if pg_response_code is in $errorCodes array</span></li>
<li><a name="a162"></a>    </li>
<li><a name="a163"></a>    <span class="src-key">function </span><a href="../ACH/ACH.html#methodchkError">chkError</a><span class="src-sym">(</span><span class="src-var">$err</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a164"></a>        <span class="src-var">$send</span>=<span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a165"></a>        </li>
<li><a name="a166"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$err</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a167"></a>            <span class="src-var">$sub</span>=<span class="src-str">&quot;ACH CLASS ERROR: &quot;</span><span class="src-sym">;</span></li>
<li><a name="a168"></a>            <span class="src-var">$send</span>=<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a169"></a>            <span class="src-key">switch </span><span class="src-sym">(</span><span class="src-var">$err</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a170"></a>                <span class="src-key">case </span><span class="src-str">'1'</span>:</li>
<li><a name="a171"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;\n\nCLASS ERROR: setFields()\n\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a172"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a173"></a>                <span class="src-key">case </span><span class="src-str">'2'</span>:</li>
<li><a name="a174"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;\n\nCLASS ERROR: setMessage()\n\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a175"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a176"></a>                <span class="src-key">case </span><span class="src-str">'3'</span>:</li>
<li><a name="a177"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;\n\nCLASS ERROR: runTransaction() May be curl connection problem or no posturl supplied\n\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a178"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a179"></a>                <span class="src-key">case </span><span class="src-str">'4'</span>:</li>
<li><a name="a180"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;\n\nCLASS ERROR: parseResponse()\n\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a181"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a182"></a>                <span class="src-key">case </span><span class="src-str">'5'</span>:</li>
<li><a name="a183"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;\n\nCLASS ERROR: setTransactionDescription()\n\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a184"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a185"></a>                <span class="src-key">case </span><span class="src-str">'6'</span>:</li>
<li><a name="a186"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;\n\nCLASS ERROR: getDisplayText()\n\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a187"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a188"></a>                <span class="src-key">case </span><span class="src-str">'7'</span>:</li>
<li><a name="a189"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;</span><span class="src-str">\n\n<span class="src-id">CLASS</span> <span class="src-id">ERROR</span>: <span class="src-var">$msg</span> <span class="src-id">is</span> <span class="src-id">not</span> <span class="src-id">an</span> <span class="src-id">array</span> <span class="src-id">in</span> <span class="src-id">ACH</span>()\n\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a190"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a191"></a>                <span class="src-key">default</span>:</li>
<li><a name="a192"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;\n\nCLASS ERROR: Unspecified\n\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a193"></a>            <span class="src-sym">}</span></li>
<li><a name="a194"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a195"></a>            <span class="src-var">$sub</span>=<span class="src-str">&quot;ACH ERROR: &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_response_code'</span><span class="src-sym">]</span>.<span class="src-str">&quot;-&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_response_description'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a196"></a>        <span class="src-sym">}</span></li>
<li><a name="a197"></a>        </li>
<li><a name="a198"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$error_codes">error_codes</a><span class="src-sym">) </span>|| <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$debug">debug</a><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a199"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$error_codes">error_codes</a><span class="src-sym">) </span>|| <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$debug">debug</a><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a200"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">[</span><span class="src-str">'pg_response_code'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$error_codes">error_codes</a><span class="src-sym">) </span>|| <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$debug">debug</a><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a201"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;TRANSACTION TYPE: &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$trans">trans</a>.<span class="src-str">&quot;\n\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a202"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;TRANSACTION MESSAGE:\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a203"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$t_properties">t_properties</a><span class="src-sym">))</span><span class="src-sym">{</span></li>
<li><a name="a204"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$t_properties">t_properties</a><span class="src-sym">))</span><span class="src-sym">{</span></li>
<li><a name="a205"></a>                            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$t_properties">t_properties</a> <span class="src-key">AS </span><span class="src-var">$k</span>=&gt;<span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a206"></a>                                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$k </span>!= <span class="src-str">'ecom_payment_check_account' </span>&amp;&amp; <span class="src-var">$k </span>!= <span class="src-str">'ecom_payment_check_trn' </span>&amp;&amp; <span class="src-var">$k </span>!= <span class="src-str">'pg_password'</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a207"></a>                                    <span class="src-var">$msg </span>.= <span class="src-var">$k</span><span class="src-sym">;</span></li>
<li><a name="a208"></a>                                    <span class="src-key">for</span><span class="src-sym">(</span><span class="src-var">$i</span>=<a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-var">$i</span>&lt;<span class="src-num">34</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">)</span><span class="src-sym">{ </span><span class="src-var">$msg</span>.=<span class="src-str">&quot; &quot;</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a209"></a>                                    <span class="src-var">$msg </span>.= <span class="src-str">&quot;= &quot;</span>.<span class="src-var">$v</span>.<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a210"></a>                                <span class="src-sym">}</span></li>
<li><a name="a211"></a>                            <span class="src-sym">}</span></li>
<li><a name="a212"></a>                            <span class="src-var">$msg</span>.=<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a213"></a>                        <span class="src-sym">}</span></li>
<li><a name="a214"></a>                    <span class="src-sym">}</span></li>
<li><a name="a215"></a>                    <span class="src-var">$msg</span>.=<span class="src-str">&quot;RESPONSE MESSAGE:\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a216"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">))</span><span class="src-sym">{</span></li>
<li><a name="a217"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a><span class="src-sym">))</span><span class="src-sym">{</span></li>
<li><a name="a218"></a>                            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH_core/ACH_core.html#var$r_properties">r_properties</a> <span class="src-key">AS </span><span class="src-var">$k</span>=&gt;<span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a219"></a>                                <span class="src-var">$msg </span>.= <span class="src-var">$k</span><span class="src-sym">;</span></li>
<li><a name="a220"></a>                                <span class="src-key">for</span><span class="src-sym">(</span><span class="src-var">$i</span>=<a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-var">$i</span>&lt;<span class="src-num">30</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">)</span><span class="src-sym">{ </span><span class="src-var">$msg</span>.=<span class="src-str">&quot; &quot;</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a221"></a>                                <span class="src-var">$msg </span>.= <span class="src-str">&quot;= &quot;</span>.<span class="src-var">$v</span>.<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a222"></a>                            <span class="src-sym">}</span></li>
<li><a name="a223"></a>                            <span class="src-var">$msg</span>.=<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a224"></a>                        <span class="src-sym">}</span></li>
<li><a name="a225"></a>                    <span class="src-sym">}</span></li>
<li><a name="a226"></a>                    <span class="src-var">$send</span>=<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a227"></a>                <span class="src-sym">}</span></li>
<li><a name="a228"></a>            <span class="src-sym">}</span></li>
<li><a name="a229"></a>        <span class="src-sym">}</span></li>
<li><a name="a230"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$debug">debug</a><span class="src-sym">)</span><span class="src-sym">{</span></li>
<li><a name="a231"></a>            echo <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;\t&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;\n&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&lt;br&gt;&quot;</span><span class="src-sym">,</span><a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;\n\n&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&lt;P&gt;&quot;</span><span class="src-sym">,</span><span class="src-var">$sub</span>.<span class="src-str">&quot;&lt;P&gt;&quot;</span>.<span class="src-var">$msg</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a232"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$send</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a233"></a>            <a href="http://www.php.net/mail">mail</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../ACH/ACH.html#var$errorEmail">errorEmail</a><span class="src-sym">,</span><span class="src-var">$sub</span><span class="src-sym">,</span><span class="src-var">$msg</span><span class="src-sym">,</span><span class="src-str">&quot;FROM: marc@wvmt.com&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a234"></a>        <span class="src-sym">}</span></li>
<li><a name="a235"></a>    <span class="src-sym">}</span></li>
<li><a name="a236"></a><span class="src-sym">}</span></li>
<li><a name="a237"></a><span class="src-php">?&gt;</span></li>
</ol></pre>
</div>
	<p class="notes" id="credit">
		Documentation generated on Mon, 19 Jul 2010 20:30:49 -0500 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.3.0RC3</a>
	</p>
	</body>
</html>