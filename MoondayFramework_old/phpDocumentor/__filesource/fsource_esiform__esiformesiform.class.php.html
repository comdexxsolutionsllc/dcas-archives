<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>File Source for esiform.class.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
						<h1>Source for file esiform.class.php</h1>
<p>Documentation is available at <a href="../esiform/_esiform_esiform_class_php.html">esiform.class.php</a></p>
<div class="src-code">
<pre><ol><li><a name="a1"></a><span class="src-php">&lt;?php</span></li>
<li><a name="a2"></a><span class="src-doc">/**</span></li>
<li><a name="a3"></a><span class="src-doc">* </span><span class="src-doc-coretag">@package</span><span class="src-doc"> esiform</span></li>
<li><a name="a4"></a><span class="src-doc">* </span><span class="src-doc-coretag">@author</span><span class="src-doc"> Joshua Abbott, WiseGene Project (NKommunikation)</span></li>
<li><a name="a5"></a><span class="src-doc">* </span><span class="src-doc-coretag">@copyright</span><span class="src-doc"> (C) 2006 NKommunikation. All Rights Reserved.</span></li>
<li><a name="a6"></a><span class="src-doc">* </span><span class="src-doc-tag">@desc</span><span class="src-doc"> EasyForm class</span></li>
<li><a name="a7"></a><span class="src-doc">* </span><span class="src-doc-coretag">@uses</span></li>
<li><a name="a8"></a><span class="src-doc">* </span><span class="src-doc-coretag">@example</span></li>
<li><a name="a9"></a><span class="src-doc">* </span><span class="src-doc-tag">@files</span></li>
<li><a name="a10"></a><span class="src-doc">*/</span></li>
<li><a name="a11"></a>&nbsp;</li>
<li><a name="a12"></a>    <span class="src-doc">/**</span></li>
<li><a name="a13"></a><span class="src-doc">     *</span></li>
<li><a name="a14"></a><span class="src-doc">     * Description:</span></li>
<li><a name="a15"></a><span class="src-doc">     * ------------</span></li>
<li><a name="a16"></a><span class="src-doc">     *     </span></li>
<li><a name="a17"></a><span class="src-doc">     * This class is meant to create_, validate and process Web forms.</span></li>
<li><a name="a18"></a><span class="src-doc">     *</span></li>
<li><a name="a19"></a><span class="src-doc">     * When a valid form is submitted, the class can execute several types</span></li>
<li><a name="a20"></a><span class="src-doc">     * of built-in follow-up actions.</span></li>
<li><a name="a21"></a><span class="src-doc">     *</span></li>
<li><a name="a22"></a><span class="src-doc">     * Currently it supports executing these types of follow-up actions:</span></li>
<li><a name="a23"></a><span class="src-doc">     *</span></li>
<li><a name="a24"></a><span class="src-doc">     * + Send an e-mail message to a given address based on a template that can</span></li>
<li><a name="a25"></a><span class="src-doc">     *   be processed using the submitted form values</span></li>
<li><a name="a26"></a><span class="src-doc">     * + Resubmit the form data to a given Web server using HTTP POST method</span></li>
<li><a name="a27"></a><span class="src-doc">     * + Execute a database query</span></li>
<li><a name="a28"></a><span class="src-doc">     *</span></li>
<li><a name="a29"></a><span class="src-doc">     * The class supports defining forms with many types of built-in validation</span></li>
<li><a name="a30"></a><span class="src-doc">     * rules including form field interdependency.</span></li>
<li><a name="a31"></a><span class="src-doc">     *</span></li>
<li><a name="a32"></a><span class="src-doc">     */</span></li>
<li><a name="a33"></a>    </li>
<li><a name="a34"></a>    <span class="src-key">class </span><a href="../esiform/esiform.html">esiform</a></li>
<li><a name="a35"></a>    <span class="src-sym">{</span></li>
<li><a name="a36"></a>&nbsp;</li>
<li><a name="a37"></a>&nbsp;</li>
<li><a name="a38"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$error_color">$error_color</a>             = <span class="src-str">'#f00'</span><span class="src-sym">;</span></li>
<li><a name="a39"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$error_message">$error_message</a>         = <span class="src-str">'&lt;p style=&quot;font-size:18px;color:#f00&quot; class=&quot;esiform-error-message&quot;&gt;Please correct / fill the red marked fields!&lt;/p&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a40"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$error_occur">$error_occur</a>            = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a41"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$default_pattern">$default_pattern</a>        = <span class="src-str">'{field}&amp;nbsp;{name}&amp;nbsp;'</span><span class="src-sym">;</span></li>
<li><a name="a42"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$field_settings">$field_settings</a>        = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a43"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$finished_fields">$finished_fields</a>        = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a44"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$follow_ups">$follow_ups</a>             = <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a45"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$is_error">$is_error</a>                = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a46"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$load_javascript">$load_javascript</a>        = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a47"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$method_type">$method_type</a>            = <span class="src-str">'post'</span><span class="src-sym">;</span></li>
<li><a name="a48"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$post_values">$post_values</a>            = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a49"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$required_sign">$required_sign</a>         = <span class="src-str">'&lt;sup&gt;*&lt;/sup&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a50"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$required_sign_pos">$required_sign_pos</a>     = <span class="src-str">'front'</span><span class="src-sym">;</span></li>
<li><a name="a51"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$return_type">$return_type</a>             = <span class="src-str">'print'</span><span class="src-sym">;</span></li>
<li><a name="a52"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$return">$return</a>                    = <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a53"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$sexyness">$sexyness</a>                = <span class="src-id">true</span><span class="src-sym">;        </span><span class="src-comm">/* necessary for nice animations ... */</span></li>
<li><a name="a54"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$socket_returns">$socket_returns</a>        = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a55"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$template">$template</a>                = <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a56"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$valid_email_syntax">$valid_email_syntax</a> = <span class="src-str">'^[_a-zA-Z0-9-]+(\.[_a-zA-Z0-9-]+)*@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.(([0-9]{1,3})|([a-zA-Z]{2,6})|(aero|coop|info|museum|name))$'</span><span class="src-sym">;</span></li>
<li><a name="a57"></a>        <span class="src-key">var </span><a href="../esiform/esiform.html#var$xhtml">$xhtml</a>                    = <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a58"></a>        </li>
<li><a name="a59"></a>&nbsp;</li>
<li><a name="a60"></a>        <span class="src-doc">/**</span></li>
<li><a name="a61"></a><span class="src-doc">         *</span></li>
<li><a name="a62"></a><span class="src-doc">         * constructor</span></li>
<li><a name="a63"></a><span class="src-doc">         *</span></li>
<li><a name="a64"></a><span class="src-doc">         */</span></li>
<li><a name="a65"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodesiform">esiform</a><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">)</span></li>
<li><a name="a66"></a>        <span class="src-sym">{</span></li>
<li><a name="a67"></a>&nbsp;</li>
<li><a name="a68"></a>            <span class="src-comm">/* find relative path to esiform-libs */</span></li>
<li><a name="a69"></a>            <span class="src-var">$class_path </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;\\&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;/&quot;</span><span class="src-sym">,</span><a href="http://www.php.net/dirname">dirname</a><span class="src-sym">(</span>__FILE__<span class="src-sym">))</span>.<span class="src-str">'/'</span><span class="src-sym">;</span></li>
<li><a name="a70"></a>            <span class="src-var">$script_path </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;\\&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;/&quot;</span><span class="src-sym">,</span><a href="http://www.php.net/dirname">dirname</a><span class="src-sym">(</span><span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">&quot;SCRIPT_FILENAME&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a71"></a>            list<span class="src-sym">(</span><span class="src-var">$null</span><span class="src-sym">,</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;lib-path&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span>= <a href="http://www.php.net/preg_split">preg_split</a><span class="src-sym">(</span><span class="src-str">'#'</span>.<span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">&quot;DOCUMENT_ROOT&quot;</span><span class="src-sym">]</span>.<span class="src-str">'#'</span><span class="src-sym">,</span><span class="src-var">$class_path</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a72"></a>    </li>
<li><a name="a73"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a> =<span class="src-sym">&amp; </span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;fields&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a74"></a>            </li>
<li><a name="a75"></a>            <span class="src-comm">/* config init */</span></li>
<li><a name="a76"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;error-message&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$error_message">error_message</a> = <span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;error-message&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a77"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;error-color&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$error_color">error_color</a> = <span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;error-color&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a78"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;follow-ups&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$follow_ups">follow_ups</a> = <span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;follow-ups&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a79"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;method-type&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$method_type">method_type</a> = <span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;method-type&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a80"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;required-sign&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$required_sign">required_sign</a> = <span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;required-sign&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a81"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;required-sign-pos&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$required_sign_pos">required_sign_pos</a> = <span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;required-sign-pos&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a82"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;return-type&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$return_type">return_type</a> = <span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;return-type&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a83"></a>            <span class="src-key">if</span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;sexyness&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">!</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;sexyness&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$sexyness">sexyness</a> = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a84"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;xhtml&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$xhtml">xhtml</a> = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a85"></a>&nbsp;</li>
<li><a name="a86"></a>            <span class="src-comm">/* start a session */</span></li>
<li><a name="a87"></a>            <a href="http://www.php.net/session_start">session_start</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a88"></a>            </li>
<li><a name="a89"></a>            <span class="src-comm">/* copy the correct post values */</span></li>
<li><a name="a90"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$method_type">method_type</a> == <span class="src-str">'post'</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a> = <span class="src-var">$_POST</span><span class="src-sym">; </span><span class="src-key">else </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a> = <span class="src-var">$_GET</span><span class="src-sym">;</span></li>
<li><a name="a91"></a>                </li>
<li><a name="a92"></a>            <span class="src-comm">/* get template */</span></li>
<li><a name="a93"></a>            <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_file">is_file</a><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;template&quot;</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a> = <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><a href="http://www.php.net/file">file</a><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;template&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a94"></a>            <span class="src-key">else </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a> = <span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;template&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a95"></a>            </li>
<li><a name="a96"></a>            <span class="src-comm">/* create_ fields */</span></li>
<li><a name="a97"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FormFields">create_FormFields</a><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;fields&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a98"></a>            </li>
<li><a name="a99"></a>            <span class="src-comm">/* call follow-ups if validation is true */</span></li>
<li><a name="a100"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-str">&quot;esiform-post-marker&quot;</span><span class="src-sym">] </span>&amp;&amp; <span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$error_occur">error_occur</a> &amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$follow_ups">follow_ups</a><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUps_Start">followUps_Start</a><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;follow-ups&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a101"></a>            </li>
<li><a name="a102"></a>            <span class="src-comm">/* return template */</span></li>
<li><a name="a103"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodreturn_finishedTemplate">return_finishedTemplate</a><span class="src-sym">(</span><span class="src-var">$settings</span><span class="src-sym">[</span><span class="src-str">&quot;config&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a104"></a><span class="src-comm">#            echo '&lt;pre style=&quot;background-color:#ccc;padding:20px&quot;&gt;'.htmlspecialchars($this-&gt;template).'&lt;/pre&gt;';</span></li>
<li><a name="a105"></a>            </li>
<li><a name="a106"></a>        <span class="src-sym">}</span></li>
<li><a name="a107"></a>&nbsp;</li>
<li><a name="a108"></a>&nbsp;</li>
<li><a name="a109"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a110"></a>&nbsp;</li>
<li><a name="a111"></a>&nbsp;</li>
<li><a name="a112"></a>        <span class="src-doc">/**</span></li>
<li><a name="a113"></a><span class="src-doc">         *</span></li>
<li><a name="a114"></a><span class="src-doc">         *</span></li>
<li><a name="a115"></a><span class="src-doc">         *</span></li>
<li><a name="a116"></a><span class="src-doc">         */</span></li>
<li><a name="a117"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodcreate_FormFields">create_FormFields</a><span class="src-sym">(</span><span class="src-var">$fields_array</span><span class="src-sym">)</span></li>
<li><a name="a118"></a>        <span class="src-sym">{</span></li>
<li><a name="a119"></a>            </li>
<li><a name="a120"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$fields_array </span><span class="src-key">as </span><span class="src-var">$fid </span>=&gt; <span class="src-var">$fsettings</span><span class="src-sym">)</span></li>
<li><a name="a121"></a>            <span class="src-sym">{</span></li>
<li><a name="a122"></a>                </li>
<li><a name="a123"></a>                <span class="src-var">$label             </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a124"></a>                <span class="src-var">$describ         </span>= <span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;describ&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a125"></a>                <span class="src-var">$created_field    </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a126"></a>&nbsp;</li>
<li><a name="a127"></a>                <span class="src-comm">/* set required sign */</span></li>
<li><a name="a128"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;required&quot;</span><span class="src-sym">] </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">] </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;required-sign&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span>|| <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;required-sign&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a129"></a>                <span class="src-sym">{</span></li>
<li><a name="a130"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$required_sign_pos">required_sign_pos</a> == <span class="src-str">'front'</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$required_sign">required_sign</a>.<span class="src-str">'&amp;nbsp;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a131"></a>                    <span class="src-key">else </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">] </span>+= <span class="src-str">'&amp;nbsp;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$required_sign">required_sign</a><span class="src-sym">;</span></li>
<li><a name="a132"></a>                <span class="src-sym">}</span></li>
<li><a name="a133"></a>                </li>
<li><a name="a134"></a>                <span class="src-comm">/* activate fields */</span></li>
<li><a name="a135"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;activate&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodvalidate_activateFields">validate_activateFields</a><span class="src-sym">(</span><span class="src-var">$fid</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a136"></a>    </li>
<li><a name="a137"></a>                <span class="src-comm">/* validate if necessary */</span></li>
<li><a name="a138"></a>                <span class="src-var">$fsettings </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodvalidate_formFields">validate_formFields</a><span class="src-sym">(</span><span class="src-var">$fid</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a139"></a>                    </li>
<li><a name="a140"></a>                <span class="src-comm">/* if box-hide == true */</span></li>
<li><a name="a141"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;box-hide&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$load_javascript">load_javascript</a><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-str">&quot;</span><span class="src-str"><span class="src-id">if</span>($('<span class="src-id">field</span>-<span class="src-id">box</span>-</span><span class="src-str">&quot;</span>.<span class="src-var">$fid</span>.<span class="src-str">&quot;</span><span class="src-str">')) $('<span class="src-id">field</span>-<span class="src-id">box</span>-</span><span class="src-str">&quot;</span>.<span class="src-var">$fid</span>.<span class="src-str">&quot;').style.display = 'none';&quot;</span><span class="src-sym">;</span></li>
<li><a name="a142"></a>&nbsp;</li>
<li><a name="a143"></a>                <span class="src-comm">/* text, password, email, hidden fields */</span></li>
<li><a name="a144"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'text' </span>|| <span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'password' </span>|| <span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'email' </span>|| <span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'hidden'</span><span class="src-sym">) </span>list<span class="src-sym">(</span><span class="src-var">$label</span><span class="src-sym">,</span><span class="src-var">$created_field</span><span class="src-sym">) </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_TextFields">create_TextFields</a><span class="src-sym">(</span><span class="src-var">$fid</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a145"></a>                </li>
<li><a name="a146"></a>                <span class="src-comm">/* text fields */</span></li>
<li><a name="a147"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'textarea'</span><span class="src-sym">) </span>list<span class="src-sym">(</span><span class="src-var">$label</span><span class="src-sym">,</span><span class="src-var">$created_field</span><span class="src-sym">) </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_TextareaFields">create_TextareaFields</a><span class="src-sym">(</span><span class="src-var">$fid</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a148"></a>&nbsp;</li>
<li><a name="a149"></a>                <span class="src-comm">/* checkbox &amp; radio fields */</span></li>
<li><a name="a150"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'checkbox' </span>|| <span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'radio'</span><span class="src-sym">) </span>list<span class="src-sym">(</span><span class="src-var">$label</span><span class="src-sym">,</span><span class="src-var">$created_field</span><span class="src-sym">) </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_CheckboxRadioFields">create_CheckboxRadioFields</a><span class="src-sym">(</span><span class="src-var">$fid</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a151"></a>&nbsp;</li>
<li><a name="a152"></a>                <span class="src-comm">/* drop down fields */</span></li>
<li><a name="a153"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'select'</span><span class="src-sym">) </span>list<span class="src-sym">(</span><span class="src-var">$label</span><span class="src-sym">,</span><span class="src-var">$created_field</span><span class="src-sym">) </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_DropDownFields">create_DropDownFields</a><span class="src-sym">(</span><span class="src-var">$fid</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a154"></a>&nbsp;</li>
<li><a name="a155"></a>                <span class="src-comm">/* save finished fields */</span></li>
<li><a name="a156"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$finished_fields">finished_fields</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">] </span>= <span class="src-key">array</span></li>
<li><a name="a157"></a>                <span class="src-sym">(</span></li>
<li><a name="a158"></a>                    <span class="src-str">&quot;label&quot;            </span>=&gt; <span class="src-str">'&lt;span class=&quot;esiform-label&quot;&gt;'</span>.<span class="src-var">$label</span>.<span class="src-str">'&lt;/span&gt;'</span><span class="src-sym">,</span></li>
<li><a name="a159"></a>                    <span class="src-str">&quot;describ&quot;        </span>=&gt; <span class="src-str">'&lt;span class=&quot;esiform-describ&quot;&gt;'</span>.<span class="src-var">$describ</span>.<span class="src-str">'&lt;/span&gt;'</span><span class="src-sym">,</span></li>
<li><a name="a160"></a>                    <span class="src-str">&quot;field&quot;            </span>=&gt; <span class="src-var">$created_field</span><span class="src-sym">,</span></li>
<li><a name="a161"></a>                    <span class="src-str">&quot;error-text&quot;    </span>=&gt; <span class="src-str">'&lt;span style=&quot;color:'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$error_color">error_color</a>.<span class="src-str">'&quot; class=&quot;esiform-error-text&quot;&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;error-text&quot;</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/span&gt;'</span><span class="src-sym">,</span></li>
<li><a name="a162"></a>                <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a163"></a>                    </li>
<li><a name="a164"></a>            <span class="src-sym">}</span></li>
<li><a name="a165"></a>            </li>
<li><a name="a166"></a>        <span class="src-sym">}</span></li>
<li><a name="a167"></a>&nbsp;</li>
<li><a name="a168"></a>&nbsp;</li>
<li><a name="a169"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a170"></a>&nbsp;</li>
<li><a name="a171"></a>&nbsp;</li>
<li><a name="a172"></a>        <span class="src-doc">/**</span></li>
<li><a name="a173"></a><span class="src-doc">         *</span></li>
<li><a name="a174"></a><span class="src-doc">         *</span></li>
<li><a name="a175"></a><span class="src-doc">         *</span></li>
<li><a name="a176"></a><span class="src-doc">         */</span></li>
<li><a name="a177"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodcreate_TextFields">create_TextFields</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span></li>
<li><a name="a178"></a>        <span class="src-sym">{</span></li>
<li><a name="a179"></a>&nbsp;</li>
<li><a name="a180"></a>            <span class="src-comm">/* set pre-value */</span></li>
<li><a name="a181"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-str">&quot;esiform-post-marker&quot;</span><span class="src-sym">] </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a182"></a>&nbsp;</li>
<li><a name="a183"></a>            <span class="src-var">$label </span>= <span class="src-str">'&lt;label for=&quot;'</span>.<span class="src-var">$field_id</span>.<span class="src-str">'&quot;&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/label&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a184"></a>            <span class="src-var">$created_field </span>= <span class="src-str">'&lt;input type=&quot;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">]</span>.<span class="src-str">'&quot; id=&quot;'</span>.<span class="src-var">$field_id</span>.<span class="src-str">'&quot; name=&quot;'</span>.<span class="src-var">$field_id</span>.<span class="src-str">'&quot; value=&quot;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span>.<span class="src-str">'&quot;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldAttributes">create_FieldAttributes</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldStyles">create_FieldStyles</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldEvents">create_FieldEvents</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-str">' /&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a185"></a>&nbsp;</li>
<li><a name="a186"></a>            <span class="src-key">return </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$label</span><span class="src-sym">,</span><span class="src-var">$created_field</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a187"></a>            </li>
<li><a name="a188"></a>        <span class="src-sym">}</span></li>
<li><a name="a189"></a>&nbsp;</li>
<li><a name="a190"></a>&nbsp;</li>
<li><a name="a191"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a192"></a>&nbsp;</li>
<li><a name="a193"></a>&nbsp;</li>
<li><a name="a194"></a>        <span class="src-doc">/**</span></li>
<li><a name="a195"></a><span class="src-doc">         *</span></li>
<li><a name="a196"></a><span class="src-doc">         *</span></li>
<li><a name="a197"></a><span class="src-doc">         *</span></li>
<li><a name="a198"></a><span class="src-doc">         */</span></li>
<li><a name="a199"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodcreate_TextareaFields">create_TextareaFields</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span></li>
<li><a name="a200"></a>        <span class="src-sym">{</span></li>
<li><a name="a201"></a>&nbsp;</li>
<li><a name="a202"></a>            <span class="src-comm">/* set pre-value */</span></li>
<li><a name="a203"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-str">&quot;esiform-post-marker&quot;</span><span class="src-sym">] </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;value&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a204"></a>&nbsp;</li>
<li><a name="a205"></a>            <span class="src-var">$label </span>= <span class="src-str">'&lt;label for=&quot;'</span>.<span class="src-var">$field_id</span>.<span class="src-str">'&quot;&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/label&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a206"></a>            <span class="src-var">$created_field </span>= <span class="src-str">'&lt;textarea id=&quot;'</span>.<span class="src-var">$field_id</span>.<span class="src-str">'&quot; name=&quot;'</span>.<span class="src-var">$field_id</span>.<span class="src-str">'&quot;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldAttributes">create_FieldAttributes</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldStyles">create_FieldStyles</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldEvents">create_FieldEvents</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-str">'&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/textarea&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a207"></a>&nbsp;</li>
<li><a name="a208"></a>            <span class="src-key">return </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$label</span><span class="src-sym">,</span><span class="src-var">$created_field</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a209"></a>            </li>
<li><a name="a210"></a>        <span class="src-sym">}</span></li>
<li><a name="a211"></a>&nbsp;</li>
<li><a name="a212"></a>&nbsp;</li>
<li><a name="a213"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a214"></a>&nbsp;</li>
<li><a name="a215"></a>&nbsp;</li>
<li><a name="a216"></a>        <span class="src-doc">/**</span></li>
<li><a name="a217"></a><span class="src-doc">         *</span></li>
<li><a name="a218"></a><span class="src-doc">         *</span></li>
<li><a name="a219"></a><span class="src-doc">         *</span></li>
<li><a name="a220"></a><span class="src-doc">         */</span></li>
<li><a name="a221"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodcreate_CheckboxRadioFields">create_CheckboxRadioFields</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span></li>
<li><a name="a222"></a>        <span class="src-sym">{</span></li>
<li><a name="a223"></a>&nbsp;</li>
<li><a name="a224"></a>            <span class="src-var">$label </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a225"></a>&nbsp;</li>
<li><a name="a226"></a>            <span class="src-var">$options </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a227"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;values&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$ok </span>=&gt; <span class="src-var">$ov</span><span class="src-sym">)</span></li>
<li><a name="a228"></a>            <span class="src-sym">{</span></li>
<li><a name="a229"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;keys&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$ok </span>= <span class="src-var">$ov</span><span class="src-sym">;</span></li>
<li><a name="a230"></a>                </li>
<li><a name="a231"></a>                <span class="src-comm">/* set array brackets for checkbox-fields */</span></li>
<li><a name="a232"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'checkbox'</span><span class="src-sym">) </span><span class="src-var">$set_multiple </span>= <span class="src-str">'['</span>.<span class="src-var">$ok</span>.<span class="src-str">']'</span><span class="src-sym">; </span><span class="src-key">else </span><span class="src-var">$set_multiple </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a233"></a>&nbsp;</li>
<li><a name="a234"></a>                <span class="src-comm">/* set selection */</span></li>
<li><a name="a235"></a>                <span class="src-key">if</span><span class="src-sym">( </span></li>
<li><a name="a236"></a>                    <span class="src-sym">( </span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-str">&quot;esiform-post-marker&quot;</span><span class="src-sym">] </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;select&quot;</span><span class="src-sym">] </span>&amp;&amp; <a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$ok</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;select&quot;</span><span class="src-sym">]</span><span class="src-sym">) ) </span>|| </li>
<li><a name="a237"></a>                    <span class="src-sym">(</span></li>
<li><a name="a238"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-str">&quot;esiform-post-marker&quot;</span><span class="src-sym">] </span>&amp;&amp;    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">] </span>&amp;&amp;</li>
<li><a name="a239"></a>                        <span class="src-sym">(</span></li>
<li><a name="a240"></a>                            <span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$ok</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">)) </span>||</li>
<li><a name="a241"></a>                            <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$ok </span>== <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a242"></a>                        <span class="src-sym">)</span></li>
<li><a name="a243"></a>                    <span class="src-sym">)</span></li>
<li><a name="a244"></a>                <span class="src-sym">) </span><span class="src-var">$set_selected </span>= <span class="src-str">' checked'</span><span class="src-sym">; </span><span class="src-key">else </span><span class="src-var">$set_selected </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a245"></a>&nbsp;</li>
<li><a name="a246"></a>                <span class="src-comm">/* if there is no field-label defined, mark the option-values in the given error-color */</span></li>
<li><a name="a247"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">] </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$is_error">is_error</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$ov </span>= <span class="src-str">'&lt;span style=&quot;color:'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$error_color">error_color</a>.<span class="src-str">'&quot;&gt;'</span>.<span class="src-var">$ov</span>.<span class="src-str">'&lt;/span&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a248"></a>&nbsp;</li>
<li><a name="a249"></a>                <span class="src-comm">/* if there is no pattern, take the default one */</span></li>
<li><a name="a250"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;pattern&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;pattern&quot;</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$default_pattern">default_pattern</a><span class="src-sym">;</span></li>
<li><a name="a251"></a>                <span class="src-var">$options</span><span class="src-sym">[</span><span class="src-sym">] </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">'{name}'</span><span class="src-sym">,</span><span class="src-str">'&lt;label for=&quot;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">]</span>.<span class="src-str">'-field-'</span>.<span class="src-var">$field_id</span>.<span class="src-str">'-'</span>.<span class="src-var">$ok</span>.<span class="src-str">'&quot;&gt;'</span>.<span class="src-var">$ov</span>.<span class="src-str">'&lt;/label&gt;'</span><span class="src-sym">,</span><a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{field}&quot;</span><span class="src-sym">,</span><span class="src-str">'&lt;input type=&quot;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">]</span>.<span class="src-str">'&quot; id=&quot;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">]</span>.<span class="src-str">'-field-'</span>.<span class="src-var">$field_id</span>.<span class="src-str">'-'</span>.<span class="src-var">$ok</span>.<span class="src-str">'&quot; name=&quot;'</span>.<span class="src-var">$field_id</span>.<span class="src-var">$set_multiple</span>.<span class="src-str">'&quot; value=&quot;'</span>.<span class="src-var">$ok</span>.<span class="src-str">'&quot;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldAttributes">create_FieldAttributes</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldStyles">create_FieldStyles</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldEvents">create_FieldEvents</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">,</span><span class="src-var">$ok</span><span class="src-sym">)</span>.<span class="src-var">$set_selected</span>.<span class="src-str">' /&gt;'</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;pattern&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a252"></a>            <span class="src-sym">}</span></li>
<li><a name="a253"></a>&nbsp;</li>
<li><a name="a254"></a>            <span class="src-var">$created_field </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$options</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a255"></a>&nbsp;</li>
<li><a name="a256"></a>            <span class="src-key">return </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$label</span><span class="src-sym">,</span><span class="src-var">$created_field</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a257"></a>            </li>
<li><a name="a258"></a>        <span class="src-sym">}</span></li>
<li><a name="a259"></a>&nbsp;</li>
<li><a name="a260"></a>&nbsp;</li>
<li><a name="a261"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a262"></a>&nbsp;</li>
<li><a name="a263"></a>&nbsp;</li>
<li><a name="a264"></a>        <span class="src-doc">/**</span></li>
<li><a name="a265"></a><span class="src-doc">         *</span></li>
<li><a name="a266"></a><span class="src-doc">         *</span></li>
<li><a name="a267"></a><span class="src-doc">         *</span></li>
<li><a name="a268"></a><span class="src-doc">         */</span></li>
<li><a name="a269"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodcreate_DropDownFields">create_DropDownFields</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span></li>
<li><a name="a270"></a>        <span class="src-sym">{</span></li>
<li><a name="a271"></a>&nbsp;</li>
<li><a name="a272"></a>            <span class="src-var">$label </span>= <span class="src-str">'&lt;label for=&quot;'</span>.<span class="src-var">$field_id</span>.<span class="src-str">'&quot;&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/label&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a273"></a>&nbsp;</li>
<li><a name="a274"></a>            <span class="src-var">$options </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a275"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;values&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$ok </span>=&gt; <span class="src-var">$ov</span><span class="src-sym">)</span></li>
<li><a name="a276"></a>            <span class="src-sym">{</span></li>
<li><a name="a277"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;keys&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$ok </span>= <span class="src-var">$ov</span><span class="src-sym">;</span></li>
<li><a name="a278"></a>                </li>
<li><a name="a279"></a>                <span class="src-comm">/* set selection */</span></li>
<li><a name="a280"></a>                <span class="src-key">if</span><span class="src-sym">( </span></li>
<li><a name="a281"></a>                    <span class="src-sym">( </span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-str">&quot;esiform-post-marker&quot;</span><span class="src-sym">] </span>&amp;&amp; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;select&quot;</span><span class="src-sym">] </span>&amp;&amp; <a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$ok</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;select&quot;</span><span class="src-sym">]</span><span class="src-sym">) ) </span>|| </li>
<li><a name="a282"></a>                    <span class="src-sym">(</span></li>
<li><a name="a283"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-str">&quot;esiform-post-marker&quot;</span><span class="src-sym">] </span>&amp;&amp;    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">] </span>&amp;&amp;</li>
<li><a name="a284"></a>                        <span class="src-sym">(</span></li>
<li><a name="a285"></a>                            <span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$ok</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">)) </span>||</li>
<li><a name="a286"></a>                            <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$ok </span>== <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a287"></a>                        <span class="src-sym">)</span></li>
<li><a name="a288"></a>                    <span class="src-sym">)</span></li>
<li><a name="a289"></a>                <span class="src-sym">) </span><span class="src-var">$set_selected </span>= <span class="src-str">' selected'</span><span class="src-sym">; </span><span class="src-key">else </span><span class="src-var">$set_selected </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a290"></a>                </li>
<li><a name="a291"></a>                <span class="src-var">$options</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-str">'&lt;option value=&quot;'</span>.<span class="src-var">$ok</span>.<span class="src-str">'&quot;'</span>.<span class="src-var">$set_selected</span>.<span class="src-str">'&gt;'</span>.<span class="src-var">$ov</span>.<span class="src-str">'&lt;/option&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a292"></a>            <span class="src-sym">}</span></li>
<li><a name="a293"></a>&nbsp;</li>
<li><a name="a294"></a>            <span class="src-comm">/* if multiple drop down */</span></li>
<li><a name="a295"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;attributes&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;multiple&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$set_multiple </span>= <span class="src-str">'[]'</span><span class="src-sym">; </span><span class="src-key">else </span><span class="src-var">$set_multiple </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a296"></a>&nbsp;</li>
<li><a name="a297"></a>            <span class="src-comm">/* finish field */</span></li>
<li><a name="a298"></a>            <span class="src-var">$created_field </span>= <span class="src-str">'&lt;select name=&quot;'</span>.<span class="src-var">$field_id</span>.<span class="src-var">$set_multiple</span>.<span class="src-str">'&quot; id=&quot;'</span>.<span class="src-var">$field_id</span>.<span class="src-str">'&quot;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldAttributes">create_FieldAttributes</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldStyles">create_FieldStyles</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodcreate_FieldEvents">create_FieldEvents</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span>.<span class="src-str">'&gt;'</span>.<a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$options</span><span class="src-sym">)</span>.<span class="src-str">'&lt;/select&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a299"></a>&nbsp;</li>
<li><a name="a300"></a>            <span class="src-key">return </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$label</span><span class="src-sym">,</span><span class="src-var">$created_field</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a301"></a>            </li>
<li><a name="a302"></a>        <span class="src-sym">}</span></li>
<li><a name="a303"></a>&nbsp;</li>
<li><a name="a304"></a>&nbsp;</li>
<li><a name="a305"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a306"></a>&nbsp;</li>
<li><a name="a307"></a>&nbsp;</li>
<li><a name="a308"></a>        <span class="src-doc">/**</span></li>
<li><a name="a309"></a><span class="src-doc">         *</span></li>
<li><a name="a310"></a><span class="src-doc">         *</span></li>
<li><a name="a311"></a><span class="src-doc">         *</span></li>
<li><a name="a312"></a><span class="src-doc">         */</span></li>
<li><a name="a313"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodcreate_FieldStyles">create_FieldStyles</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span></li>
<li><a name="a314"></a>        <span class="src-sym">{</span></li>
<li><a name="a315"></a>&nbsp;</li>
<li><a name="a316"></a>            <span class="src-var">$style_string </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a317"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;styles&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a318"></a>            <span class="src-sym">{</span></li>
<li><a name="a319"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;styles&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$sk </span>=&gt; <span class="src-var">$sv</span><span class="src-sym">)</span></li>
<li><a name="a320"></a>                <span class="src-sym">{</span></li>
<li><a name="a321"></a>                    <span class="src-var">$style_string</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$sk</span>.<span class="src-str">':'</span>.<span class="src-var">$sv</span><span class="src-sym">;</span></li>
<li><a name="a322"></a>                <span class="src-sym">}</span></li>
<li><a name="a323"></a>                </li>
<li><a name="a324"></a>                <span class="src-key">return </span><span class="src-str">' style=&quot;'</span>.<a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;;&quot;</span><span class="src-sym">,</span><span class="src-var">$style_string</span><span class="src-sym">)</span>.<span class="src-str">'&quot;'</span><span class="src-sym">;</span></li>
<li><a name="a325"></a>            <span class="src-sym">}</span></li>
<li><a name="a326"></a>            </li>
<li><a name="a327"></a>        <span class="src-sym">}</span></li>
<li><a name="a328"></a>&nbsp;</li>
<li><a name="a329"></a>&nbsp;</li>
<li><a name="a330"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a331"></a>&nbsp;</li>
<li><a name="a332"></a>&nbsp;</li>
<li><a name="a333"></a>        <span class="src-doc">/**</span></li>
<li><a name="a334"></a><span class="src-doc">         *</span></li>
<li><a name="a335"></a><span class="src-doc">         *</span></li>
<li><a name="a336"></a><span class="src-doc">         *</span></li>
<li><a name="a337"></a><span class="src-doc">         */</span></li>
<li><a name="a338"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodcreate_FieldAttributes">create_FieldAttributes</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span></li>
<li><a name="a339"></a>        <span class="src-sym">{</span></li>
<li><a name="a340"></a>&nbsp;</li>
<li><a name="a341"></a>            <span class="src-var">$attribute_string </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a342"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;attributes&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a343"></a>            <span class="src-sym">{</span></li>
<li><a name="a344"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;attributes&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$ak </span>=&gt; <span class="src-var">$av</span><span class="src-sym">)</span></li>
<li><a name="a345"></a>                <span class="src-sym">{</span></li>
<li><a name="a346"></a>                    <span class="src-comm">/* single attributes - such as &quot;checked&quot; ... */</span></li>
<li><a name="a347"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$av</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$av</span><span class="src-sym">) </span><span class="src-var">$string </span>= <span class="src-var">$ak</span><span class="src-sym">;</span></li>
<li><a name="a348"></a>                    </li>
<li><a name="a349"></a>                    <span class="src-comm">/* key, value attributes */</span></li>
<li><a name="a350"></a>                    <span class="src-key">else </span><span class="src-var">$string </span>= <span class="src-var">$ak</span>.<span class="src-str">'=&quot;'</span>.<span class="src-var">$av</span>.<span class="src-str">'&quot;'</span><span class="src-sym">;</span></li>
<li><a name="a351"></a>                    </li>
<li><a name="a352"></a>                    <span class="src-var">$attribute_string</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$string</span><span class="src-sym">;</span></li>
<li><a name="a353"></a>                <span class="src-sym">}</span></li>
<li><a name="a354"></a>                </li>
<li><a name="a355"></a>                <span class="src-key">return </span><span class="src-str">' '</span>.<a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot; &quot;</span><span class="src-sym">,</span><span class="src-var">$attribute_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a356"></a>            <span class="src-sym">}</span></li>
<li><a name="a357"></a>            </li>
<li><a name="a358"></a>        <span class="src-sym">}</span></li>
<li><a name="a359"></a>&nbsp;</li>
<li><a name="a360"></a>&nbsp;</li>
<li><a name="a361"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a362"></a>&nbsp;</li>
<li><a name="a363"></a>&nbsp;</li>
<li><a name="a364"></a>        <span class="src-doc">/**</span></li>
<li><a name="a365"></a><span class="src-doc">         *</span></li>
<li><a name="a366"></a><span class="src-doc">         *</span></li>
<li><a name="a367"></a><span class="src-doc">         *</span></li>
<li><a name="a368"></a><span class="src-doc">         */</span></li>
<li><a name="a369"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodcreate_FieldEvents">create_FieldEvents</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">,</span><span class="src-var">$field_key </span>= <span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a370"></a>        <span class="src-sym">{</span></li>
<li><a name="a371"></a>&nbsp;</li>
<li><a name="a372"></a>            <span class="src-var">$event_string </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a373"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;events&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a374"></a>            <span class="src-sym">{</span></li>
<li><a name="a375"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;events&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$ek </span>=&gt; <span class="src-var">$ev</span><span class="src-sym">)</span></li>
<li><a name="a376"></a>                <span class="src-sym">{</span></li>
<li><a name="a377"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$ev </span><span class="src-key">as </span><span class="src-var">$event </span>=&gt; <span class="src-var">$show_after_post</span><span class="src-sym">)</span></li>
<li><a name="a378"></a>                    <span class="src-sym">{</span></li>
<li><a name="a379"></a>                        <span class="src-comm">/* when there is no bool defined, pass the event over ... */</span></li>
<li><a name="a380"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$show_after_post</span><span class="src-sym">)) </span><span class="src-var">$event </span>= <span class="src-var">$show_after_post</span><span class="src-sym">;</span></li>
<li><a name="a381"></a>                        </li>
<li><a name="a382"></a>                        <span class="src-var">$event_call </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodreplace_eventPlaceHolders">replace_eventPlaceHolders</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">,</span><span class="src-var">$event</span><span class="src-sym">,</span><span class="src-var">$field_key</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a383"></a>                        <span class="src-var">$line_events</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$event_call</span><span class="src-sym">;</span></li>
<li><a name="a384"></a>&nbsp;</li>
<li><a name="a385"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$show_after_post</span><span class="src-sym">)</span></li>
<li><a name="a386"></a>                        <span class="src-sym">{</span></li>
<li><a name="a387"></a>                            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'checkbox' </span>&amp;&amp; <span class="src-sym">( (</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$field_key</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;select&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$field_key</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;select&quot;</span><span class="src-sym">]</span><span class="src-sym">)) )) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$load_javascript">load_javascript</a><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$event_call</span><span class="src-sym">;</span></li>
<li><a name="a388"></a>                            <span class="src-key">elseif</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>!= <span class="src-str">'checkbox' </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">] </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;select&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$field_key</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;select&quot;</span><span class="src-sym">]</span><span class="src-sym">)) )) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$load_javascript">load_javascript</a><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$event_call</span><span class="src-sym">;</span></li>
<li><a name="a389"></a>                        <span class="src-sym">}</span></li>
<li><a name="a390"></a>                    <span class="src-sym">}</span></li>
<li><a name="a391"></a>&nbsp;</li>
<li><a name="a392"></a>                    <span class="src-var">$event_string</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$ek</span>.<span class="src-str">'=&quot;'</span>.<a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$line_events</span><span class="src-sym">)</span>.<span class="src-str">'&quot;'</span><span class="src-sym">;</span></li>
<li><a name="a393"></a>                <span class="src-sym">}</span></li>
<li><a name="a394"></a>                </li>
<li><a name="a395"></a>                <span class="src-key">return </span><span class="src-str">' '</span>.<a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$event_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a396"></a>            <span class="src-sym">}</span></li>
<li><a name="a397"></a>            </li>
<li><a name="a398"></a>        <span class="src-sym">}</span></li>
<li><a name="a399"></a>&nbsp;</li>
<li><a name="a400"></a>&nbsp;</li>
<li><a name="a401"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a402"></a>&nbsp;</li>
<li><a name="a403"></a>&nbsp;</li>
<li><a name="a404"></a>        <span class="src-doc">/**</span></li>
<li><a name="a405"></a><span class="src-doc">         *</span></li>
<li><a name="a406"></a><span class="src-doc">         *</span></li>
<li><a name="a407"></a><span class="src-doc">         *</span></li>
<li><a name="a408"></a><span class="src-doc">         */</span></li>
<li><a name="a409"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodreplace_eventPlaceHolders">replace_eventPlaceHolders</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">,</span><span class="src-var">$event_string</span><span class="src-sym">,</span><span class="src-var">$field_key </span>= <span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a410"></a>        <span class="src-sym">{</span></li>
<li><a name="a411"></a>            <span class="src-var">$new_event_string </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a412"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'checkbox'</span><span class="src-sym">)</span></li>
<li><a name="a413"></a>            <span class="src-sym">{</span></li>
<li><a name="a414"></a>                <span class="src-var">$event_string </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{option-id}&quot;</span><span class="src-sym">,</span><span class="src-var">$field_key</span><span class="src-sym">,</span><span class="src-var">$event_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a415"></a>                <span class="src-var">$event_string </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;this.&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;</span><span class="src-str">$('<span class="src-id">checkbox</span>-<span class="src-id">field</span>-</span><span class="src-str">&quot;</span>.<span class="src-var">$field_id</span>.<span class="src-str">&quot;-&quot;</span>.<span class="src-var">$field_key</span>.<span class="src-str">&quot;').&quot;</span><span class="src-sym">,</span><span class="src-var">$event_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a416"></a>            <span class="src-sym">}</span></li>
<li><a name="a417"></a>            <span class="src-key">else </span><span class="src-var">$event_string </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;this.&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;</span><span class="src-str">$('</span><span class="src-str">&quot;</span>.<span class="src-var">$field_id</span>.<span class="src-str">&quot;').&quot;</span><span class="src-sym">,</span><span class="src-var">$event_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a418"></a>            </li>
<li><a name="a419"></a>            <span class="src-key">return </span><span class="src-var">$event_string</span><span class="src-sym">;</span></li>
<li><a name="a420"></a>        <span class="src-sym">}</span></li>
<li><a name="a421"></a>        </li>
<li><a name="a422"></a>        </li>
<li><a name="a423"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a424"></a>&nbsp;</li>
<li><a name="a425"></a>&nbsp;</li>
<li><a name="a426"></a>        <span class="src-doc">/**</span></li>
<li><a name="a427"></a><span class="src-doc">         *</span></li>
<li><a name="a428"></a><span class="src-doc">         *</span></li>
<li><a name="a429"></a><span class="src-doc">         *</span></li>
<li><a name="a430"></a><span class="src-doc">         */</span></li>
<li><a name="a431"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodvalidate_activateFields">validate_activateFields</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span></li>
<li><a name="a432"></a>        <span class="src-sym">{</span></li>
<li><a name="a433"></a>&nbsp;</li>
<li><a name="a434"></a>            <span class="src-comm">/* set the selected values */</span></li>
<li><a name="a435"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">] </span>&amp;&amp; <a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;select&quot;</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$selected_values </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;select&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a436"></a>            <span class="src-key">else </span><span class="src-var">$selected_values </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a437"></a>            </li>
<li><a name="a438"></a>            <span class="src-comm">/* if value based activation */</span></li>
<li><a name="a439"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;activate&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;if-value&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a440"></a>            <span class="src-sym">{</span></li>
<li><a name="a441"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;activate&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;if-value&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$value </span>=&gt; <span class="src-var">$fields_to_activate</span><span class="src-sym">)</span></li>
<li><a name="a442"></a>                <span class="src-sym">{</span></li>
<li><a name="a443"></a>                    <span class="src-comm">/* first set activation-fields = false */</span></li>
<li><a name="a444"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$fields_to_activate </span><span class="src-key">as </span><span class="src-var">$fid</span><span class="src-sym">)</span></li>
<li><a name="a445"></a>                    <span class="src-sym">{</span></li>
<li><a name="a446"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;box-hide&quot;</span><span class="src-sym">] </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a447"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">] </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a448"></a>                    <span class="src-sym">}</span></li>
<li><a name="a449"></a>&nbsp;</li>
<li><a name="a450"></a>                    <span class="src-var">$do_activation </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a451"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$selected_values</span><span class="src-sym">))</span></li>
<li><a name="a452"></a>                    <span class="src-sym">{</span></li>
<li><a name="a453"></a>                        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$selected_values </span><span class="src-key">as </span><span class="src-var">$ak </span>=&gt; <span class="src-var">$av</span><span class="src-sym">)</span></li>
<li><a name="a454"></a>                        <span class="src-sym">{</span></li>
<li><a name="a455"></a>                            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;options&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;keys&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$ak </span>= <span class="src-var">$av</span><span class="src-sym">;</span></li>
<li><a name="a456"></a>                            <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#&quot;</span>.<span class="src-var">$value</span>.<span class="src-str">&quot;#i&quot;</span><span class="src-sym">,</span><span class="src-var">$ak</span><span class="src-sym">)) </span><span class="src-var">$do_activation </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a457"></a>                        <span class="src-sym">}</span></li>
<li><a name="a458"></a>                    <span class="src-sym">}</span></li>
<li><a name="a459"></a>                    <span class="src-key">elseif</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$selected_values</span><span class="src-sym">) </span>&amp;&amp; <a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#&quot;</span>.<span class="src-var">$value</span>.<span class="src-str">&quot;#i&quot;</span><span class="src-sym">,</span><span class="src-var">$selected_values</span><span class="src-sym">)) </span><span class="src-var">$do_activation </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a460"></a>                    </li>
<li><a name="a461"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$do_activation</span><span class="src-sym">)</span></li>
<li><a name="a462"></a>                    <span class="src-sym">{</span></li>
<li><a name="a463"></a>                        <span class="src-comm">/* activate given fields */</span></li>
<li><a name="a464"></a>                        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$fields_to_activate </span><span class="src-key">as </span><span class="src-var">$fid</span><span class="src-sym">)</span></li>
<li><a name="a465"></a>                        <span class="src-sym">{</span></li>
<li><a name="a466"></a>                            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;required&quot;</span><span class="src-sym">] </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a467"></a>                            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;box-hide&quot;</span><span class="src-sym">] </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a468"></a>                        <span class="src-sym">}</span></li>
<li><a name="a469"></a>                    <span class="src-sym">}</span></li>
<li><a name="a470"></a>&nbsp;</li>
<li><a name="a471"></a>                    <span class="src-comm">/* add events to the parent field to show the passed fields instantly */</span></li>
<li><a name="a472"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'select'</span><span class="src-sym">) </span><span class="src-var">$event_type </span>= <span class="src-str">'onchange'</span><span class="src-sym">; </span><span class="src-key">else </span><span class="src-var">$event_type </span>= <span class="src-str">'onclick'</span><span class="src-sym">;</span></li>
<li><a name="a473"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;events&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-var">$event_type</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;validate_activateFields('&quot;</span>.<span class="src-var">$field_id</span>.<span class="src-str">&quot;','&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">]</span>.<span class="src-str">&quot;','&quot;</span>.<span class="src-var">$value</span>.<span class="src-str">&quot;','&quot;</span>.<a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;,&quot;</span><span class="src-sym">,</span><span class="src-var">$fields_to_activate</span><span class="src-sym">)</span>.<span class="src-str">&quot;','&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$sexyness">sexyness</a>.<span class="src-str">&quot;');&quot;</span><span class="src-sym">] </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a474"></a>                <span class="src-sym">}</span></li>
<li><a name="a475"></a>            <span class="src-sym">}</span></li>
<li><a name="a476"></a>            </li>
<li><a name="a477"></a>            <span class="src-comm">/* if the field is valid, activate the following fields */</span></li>
<li><a name="a478"></a>            <span class="src-key">elseif</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;activate&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a479"></a>            <span class="src-sym">{</span></li>
<li><a name="a480"></a>                <span class="src-comm">/* first set activation-fields = false */</span></li>
<li><a name="a481"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;activate&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$fid</span><span class="src-sym">)</span></li>
<li><a name="a482"></a>                <span class="src-sym">{</span></li>
<li><a name="a483"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;box-hide&quot;</span><span class="src-sym">] </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a484"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">] </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a485"></a>                <span class="src-sym">}</span></li>
<li><a name="a486"></a>&nbsp;</li>
<li><a name="a487"></a>                <span class="src-comm">/* activate given fields */</span></li>
<li><a name="a488"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$selected_values</span><span class="src-sym">)</span></li>
<li><a name="a489"></a>                <span class="src-sym">{</span></li>
<li><a name="a490"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;activate&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$fid</span><span class="src-sym">)</span></li>
<li><a name="a491"></a>                    <span class="src-sym">{</span></li>
<li><a name="a492"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;required&quot;</span><span class="src-sym">] </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a493"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;box-hide&quot;</span><span class="src-sym">] </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a494"></a>                    <span class="src-sym">}</span></li>
<li><a name="a495"></a>                <span class="src-sym">}</span></li>
<li><a name="a496"></a>&nbsp;</li>
<li><a name="a497"></a>                <span class="src-comm">/* add events to the parent field to show the passed fields instantly */</span></li>
<li><a name="a498"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'select'</span><span class="src-sym">) </span><span class="src-var">$event_type </span>= <span class="src-str">'onchange'</span><span class="src-sym">; </span><span class="src-key">else </span><span class="src-var">$event_type </span>= <span class="src-str">'onclick'</span><span class="src-sym">;</span></li>
<li><a name="a499"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;events&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-var">$event_type</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;validate_activateFields('&quot;</span>.<span class="src-var">$field_id</span>.<span class="src-str">&quot;','&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">]</span>.<span class="src-str">&quot;','#for-all-values#','&quot;</span>.<a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;,&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;activate&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span>.<span class="src-str">&quot;','&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$sexyness">sexyness</a>.<span class="src-str">&quot;');&quot;</span><span class="src-sym">] </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a500"></a>&nbsp;</li>
<li><a name="a501"></a>            <span class="src-sym">}</span></li>
<li><a name="a502"></a>&nbsp;</li>
<li><a name="a503"></a>        <span class="src-sym">}</span></li>
<li><a name="a504"></a>        </li>
<li><a name="a505"></a>&nbsp;</li>
<li><a name="a506"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a507"></a>&nbsp;</li>
<li><a name="a508"></a>&nbsp;</li>
<li><a name="a509"></a>        <span class="src-doc">/**</span></li>
<li><a name="a510"></a><span class="src-doc">         *</span></li>
<li><a name="a511"></a><span class="src-doc">         *</span></li>
<li><a name="a512"></a><span class="src-doc">         *</span></li>
<li><a name="a513"></a><span class="src-doc">         */</span></li>
<li><a name="a514"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodvalidate_formFields">validate_formFields</a><span class="src-sym">(</span><span class="src-var">$field_id</span><span class="src-sym">)</span></li>
<li><a name="a515"></a>        <span class="src-sym">{</span></li>
<li><a name="a516"></a>            </li>
<li><a name="a517"></a>            <span class="src-var">$found_error </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a518"></a>            </li>
<li><a name="a519"></a>            <span class="src-comm">/* was there already a post? */</span></li>
<li><a name="a520"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-str">&quot;esiform-post-marker&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a521"></a>            <span class="src-sym">{</span></li>
<li><a name="a522"></a>&nbsp;</li>
<li><a name="a523"></a>                <span class="src-comm">/* replace regex-match if necessary */</span></li>
<li><a name="a524"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;replace&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a525"></a>                <span class="src-sym">{</span></li>
<li><a name="a526"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">] </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;#&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;replace&quot;</span><span class="src-sym">]</span>.<span class="src-str">&quot;#smi&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a527"></a>                <span class="src-sym">}</span></li>
<li><a name="a528"></a>            </li>
<li><a name="a529"></a>                <span class="src-comm">/* required-valid-options */</span></li>
<li><a name="a530"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;required&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a531"></a>                <span class="src-sym">{</span></li>
<li><a name="a532"></a>&nbsp;</li>
<li><a name="a533"></a>                    <span class="src-comm">/* field has to be filled */</span></li>
<li><a name="a534"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$found_error </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a535"></a>                    </li>
<li><a name="a536"></a>                    <span class="src-comm">/* if email-type, check if the syntax is correct */</span></li>
<li><a name="a537"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;type&quot;</span><span class="src-sym">] </span>== <span class="src-str">'email' </span>&amp;&amp; <span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$valid_email_syntax">valid_email_syntax</a>.<span class="src-str">&quot;#smi&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$found_error </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a538"></a>&nbsp;</li>
<li><a name="a539"></a>                    <span class="src-comm">/* field has to be equal to the values of the passed field-array */</span></li>
<li><a name="a540"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;equal-to&quot;</span><span class="src-sym">] </span>&amp;&amp; <a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;equal-to&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a541"></a>                    <span class="src-sym">{</span></li>
<li><a name="a542"></a>                        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;equal-to&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$equal_to_field_ids</span><span class="src-sym">)</span></li>
<li><a name="a543"></a>                        <span class="src-sym">{</span></li>
<li><a name="a544"></a>                            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$equal_to_field_ids</span><span class="src-sym">] </span>!= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$found_error </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a545"></a>                        <span class="src-sym">}</span></li>
<li><a name="a546"></a>                    <span class="src-sym">}</span></li>
<li><a name="a547"></a>                    </li>
<li><a name="a548"></a>                    <span class="src-comm">/* field has to have a minium of chosen options */</span></li>
<li><a name="a549"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;choose-min&quot;</span><span class="src-sym">] </span>&amp;&amp; <a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span>&lt; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;choose-min&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$found_error </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a550"></a>&nbsp;</li>
<li><a name="a551"></a>                    <span class="src-comm">/* field has to have a maximum of chosen options */</span></li>
<li><a name="a552"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;choose-max&quot;</span><span class="src-sym">] </span>&amp;&amp; <a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">) </span>&gt; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;choose-max&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$found_error </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a553"></a>&nbsp;</li>
<li><a name="a554"></a>                    <span class="src-comm">/* field has to match the given string */</span></li>
<li><a name="a555"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;match&quot;</span><span class="src-sym">] </span>&amp;&amp; <span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;valid&quot;</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;match&quot;</span><span class="src-sym">]</span>.<span class="src-str">&quot;#smi&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$found_error </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a556"></a>&nbsp;</li>
<li><a name="a557"></a>                <span class="src-sym">}</span></li>
<li><a name="a558"></a>&nbsp;</li>
<li><a name="a559"></a>                <span class="src-comm">/* if error, mark field label in error-color */</span></li>
<li><a name="a560"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$found_error</span><span class="src-sym">)</span></li>
<li><a name="a561"></a>                <span class="src-sym">{</span></li>
<li><a name="a562"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$error_occur">error_occur</a> = <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a563"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$is_error">is_error</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">] </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a564"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">] </span>= <span class="src-str">'&lt;span style=&quot;color:'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$error_color">error_color</a>.<span class="src-str">'&quot;&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">]</span>.<span class="src-str">'&lt;/span&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a565"></a>                <span class="src-sym">}</span></li>
<li><a name="a566"></a>                <span class="src-key">else </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$is_error">is_error</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">] </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a567"></a>&nbsp;</li>
<li><a name="a568"></a>            <span class="src-sym">}</span></li>
<li><a name="a569"></a>            </li>
<li><a name="a570"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$field_settings">field_settings</a><span class="src-sym">[</span><span class="src-var">$field_id</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a571"></a>            </li>
<li><a name="a572"></a>        <span class="src-sym">}</span></li>
<li><a name="a573"></a>        </li>
<li><a name="a574"></a>        </li>
<li><a name="a575"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a576"></a>&nbsp;</li>
<li><a name="a577"></a>&nbsp;</li>
<li><a name="a578"></a>        <span class="src-doc">/**</span></li>
<li><a name="a579"></a><span class="src-doc">         *</span></li>
<li><a name="a580"></a><span class="src-doc">         *</span></li>
<li><a name="a581"></a><span class="src-doc">         *</span></li>
<li><a name="a582"></a><span class="src-doc">         */</span></li>
<li><a name="a583"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodreturn_finishedTemplate">return_finishedTemplate</a><span class="src-sym">(</span><span class="src-var">$config</span><span class="src-sym">)</span></li>
<li><a name="a584"></a>        <span class="src-sym">{</span></li>
<li><a name="a585"></a>            </li>
<li><a name="a586"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$finished_fields">finished_fields</a> <span class="src-key">as </span><span class="src-var">$fid </span>=&gt; <span class="src-var">$fsettings</span><span class="src-sym">)</span></li>
<li><a name="a587"></a>            <span class="src-sym">{</span></li>
<li><a name="a588"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$is_error">is_error</a><span class="src-sym">[</span><span class="src-var">$fid</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;error-text&quot;</span><span class="src-sym">] </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a589"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a> = <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{&quot;</span>.<span class="src-var">$fid</span>.<span class="src-str">&quot;:label}&quot;</span><span class="src-sym">,</span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;label&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a590"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a> = <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{&quot;</span>.<span class="src-var">$fid</span>.<span class="src-str">&quot;:describ}&quot;</span><span class="src-sym">,</span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;describ&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a591"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a> = <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{&quot;</span>.<span class="src-var">$fid</span>.<span class="src-str">&quot;:error}&quot;</span><span class="src-sym">,</span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;error-text&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a592"></a>&nbsp;</li>
<li><a name="a593"></a>                <span class="src-comm">/* xhtml fittings */</span></li>
<li><a name="a594"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$xhtml">xhtml</a><span class="src-sym">) </span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;field&quot;</span><span class="src-sym">] </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot; /&gt;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&gt;&quot;</span><span class="src-sym">,</span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;field&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a595"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a> = <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{&quot;</span>.<span class="src-var">$fid</span>.<span class="src-str">&quot;:field}&quot;</span><span class="src-sym">,</span><span class="src-var">$fsettings</span><span class="src-sym">[</span><span class="src-str">&quot;field&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a596"></a>            <span class="src-sym">}</span></li>
<li><a name="a597"></a>            </li>
<li><a name="a598"></a>            <span class="src-comm">/* add prototype- &amp; esiform-classes */</span></li>
<li><a name="a599"></a>            <span class="src-var">$javascript_add_ons</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-str">'&lt;script type=&quot;text/javascript&quot; src=&quot;'</span>.<span class="src-var">$config</span><span class="src-sym">[</span><span class="src-str">&quot;lib-path&quot;</span><span class="src-sym">]</span>.<span class="src-str">'3rd-party/scriptaculous/prototype.js&quot;&gt;&lt;/script&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a600"></a>            <span class="src-var">$javascript_add_ons</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-str">'&lt;script type=&quot;text/javascript&quot; src=&quot;'</span>.<span class="src-var">$config</span><span class="src-sym">[</span><span class="src-str">&quot;lib-path&quot;</span><span class="src-sym">]</span>.<span class="src-str">'esiform.class.js&quot;&gt;&lt;/script&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a601"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$sexyness">sexyness</a><span class="src-sym">) </span><span class="src-var">$javascript_add_ons</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-str">'&lt;script type=&quot;text/javascript&quot; src=&quot;'</span>.<span class="src-var">$config</span><span class="src-sym">[</span><span class="src-str">&quot;lib-path&quot;</span><span class="src-sym">]</span>.<span class="src-str">'3rd-party/scriptaculous/scriptaculous.js&quot;&gt;&lt;/script&gt;'</span><span class="src-sym">;</span></li>
<li><a name="a602"></a>&nbsp;</li>
<li><a name="a603"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a> = <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;#(&lt;form.*?&gt;\s)#smi&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;\\1\t&quot;</span>.<a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;\r\n\t&quot;</span><span class="src-sym">,</span><span class="src-var">$javascript_add_ons</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a604"></a>&nbsp;</li>
<li><a name="a605"></a>            <span class="src-comm">/* load javascript */</span></li>
<li><a name="a606"></a>            <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$load_javascript">load_javascript</a><span class="src-sym">) </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a> = <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&lt;/form&gt;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;\r\n\t&quot;</span>.<span class="src-str">'&lt;script type=&quot;text/javascript&quot;&gt;'</span>.<span class="src-str">&quot;\r\n\t\t&quot;</span>.<a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;\r\n\t\t&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$load_javascript">load_javascript</a><span class="src-sym">)</span>.<span class="src-str">&quot;\r\n\t&quot;</span>.<span class="src-str">'&lt;/script&gt;'</span>.<span class="src-str">&quot;\r\n\r\n&lt;/form&gt;&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a607"></a>&nbsp;</li>
<li><a name="a608"></a>            <span class="src-comm">/* add post marker */</span></li>
<li><a name="a609"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a> = <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&lt;/form&gt;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;\t&quot;</span>.<span class="src-str">'&lt;input type=&quot;hidden&quot; name=&quot;esiform-post-marker&quot; value=&quot;1&quot; /&gt;'</span>.<span class="src-str">&quot;\r\n&lt;/form&gt;&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a610"></a>            </li>
<li><a name="a611"></a>            <span class="src-comm">/* show error message */</span></li>
<li><a name="a612"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$error_occur">error_occur</a><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$error_message">error_message</a> = <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a613"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a> = <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{error-message}&quot;</span><span class="src-sym">,</span><span class="src-str">'&lt;a name=&quot;esiform-error&quot;&gt;&lt;/a&gt;'</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$error_message">error_message</a><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a614"></a>&nbsp;</li>
<li><a name="a615"></a>            <span class="src-comm">/* return final template */</span></li>
<li><a name="a616"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$return_type">return_type</a> == <span class="src-str">'print'</span><span class="src-sym">) </span>echo <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a><span class="src-sym">; </span><span class="src-key">else </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$return">return</a> = <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$template">template</a><span class="src-sym">;</span></li>
<li><a name="a617"></a>&nbsp;</li>
<li><a name="a618"></a>        <span class="src-sym">}</span></li>
<li><a name="a619"></a>&nbsp;</li>
<li><a name="a620"></a>        </li>
<li><a name="a621"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a622"></a>&nbsp;</li>
<li><a name="a623"></a>&nbsp;</li>
<li><a name="a624"></a>        <span class="src-doc">/**</span></li>
<li><a name="a625"></a><span class="src-doc">         *</span></li>
<li><a name="a626"></a><span class="src-doc">         *</span></li>
<li><a name="a627"></a><span class="src-doc">         *</span></li>
<li><a name="a628"></a><span class="src-doc">         */</span></li>
<li><a name="a629"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUps_Start">followUps_Start</a><span class="src-sym">(</span><span class="src-var">$follow_ups</span><span class="src-sym">)</span></li>
<li><a name="a630"></a>        <span class="src-sym">{</span></li>
<li><a name="a631"></a>&nbsp;</li>
<li><a name="a632"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$follow_ups</span><span class="src-sym">[</span><span class="src-str">&quot;types&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$fk </span>=&gt; <span class="src-var">$fv</span><span class="src-sym">)</span></li>
<li><a name="a633"></a>            <span class="src-sym">{</span></li>
<li><a name="a634"></a>                <span class="src-comm">/* if we have conditions -&gt; check them, else give a true anyway */</span></li>
<li><a name="a635"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_Conditions">followUp_Conditions</a><span class="src-sym">(</span><span class="src-var">$fv</span><span class="src-sym">[</span><span class="src-str">&quot;conditions&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a636"></a>                <span class="src-sym">{</span></li>
<li><a name="a637"></a>                    <span class="src-comm">/*</span></li>
<li><a name="a638"></a><span class="src-comm">                        delete, replace, add fields and</span></li>
<li><a name="a639"></a><span class="src-comm">                        generate user_data-array out of the post-vars</span></li>
<li><a name="a640"></a><span class="src-comm">                    */</span></li>
<li><a name="a641"></a>                    <span class="src-var">$user_data </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_CreateUserData_Array">followUp_CreateUserData_Array</a><span class="src-sym">(</span><span class="src-var">$fv</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a642"></a>&nbsp;</li>
<li><a name="a643"></a>                    <span class="src-comm">/* call follow-ups */</span></li>
<li><a name="a644"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$fk</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">4</span><span class="src-sym">) </span>== <span class="src-str">'mail'</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_Mail">followUp_Mail</a><span class="src-sym">(</span><span class="src-var">$fv</span><span class="src-sym">,</span><span class="src-var">$user_data</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a645"></a>                    <span class="src-key">elseif</span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$fk</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">6</span><span class="src-sym">) </span>== <span class="src-str">'socket'</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_Socket">followUp_Socket</a><span class="src-sym">(</span><span class="src-var">$fv</span><span class="src-sym">,</span><span class="src-var">$user_data</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a646"></a>                    <span class="src-key">elseif</span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$fk</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">5</span><span class="src-sym">) </span>== <span class="src-str">'mysql'</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_Mysql">followUp_Mysql</a><span class="src-sym">(</span><span class="src-var">$fv</span><span class="src-sym">,</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$fk</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a647"></a>                    <span class="src-key">elseif</span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$fk</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">4</span><span class="src-sym">) </span>== <span class="src-str">'file'</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_File">followUp_File</a><span class="src-sym">(</span><span class="src-var">$fv</span><span class="src-sym">,</span><span class="src-var">$user_data</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a648"></a>                <span class="src-sym">}</span></li>
<li><a name="a649"></a>            <span class="src-sym">}</span></li>
<li><a name="a650"></a>            </li>
<li><a name="a651"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$follow_ups</span><span class="src-sym">[</span><span class="src-str">&quot;redirect&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">&quot;Location: &quot;</span>.<span class="src-var">$follow_ups</span><span class="src-sym">[</span><span class="src-str">&quot;redirect&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a652"></a>            <span class="src-key">else </span>echo <span class="src-str">&quot;&lt;h1 style=color:#0c0&gt;follow-up finished!&lt;/h1&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a653"></a>&nbsp;</li>
<li><a name="a654"></a>        <span class="src-sym">}</span></li>
<li><a name="a655"></a>        </li>
<li><a name="a656"></a>&nbsp;</li>
<li><a name="a657"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a658"></a>&nbsp;</li>
<li><a name="a659"></a>&nbsp;</li>
<li><a name="a660"></a>        <span class="src-doc">/**</span></li>
<li><a name="a661"></a><span class="src-doc">         *</span></li>
<li><a name="a662"></a><span class="src-doc">         *</span></li>
<li><a name="a663"></a><span class="src-doc">         *</span></li>
<li><a name="a664"></a><span class="src-doc">         */</span></li>
<li><a name="a665"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_Conditions">followUp_Conditions</a><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">)</span></li>
<li><a name="a666"></a>        <span class="src-sym">{</span></li>
<li><a name="a667"></a>&nbsp;</li>
<li><a name="a668"></a>            <span class="src-var">$return </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a669"></a>            </li>
<li><a name="a670"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">)</span></li>
<li><a name="a671"></a>            <span class="src-sym">{</span></li>
<li><a name="a672"></a>&nbsp;</li>
<li><a name="a673"></a>                <span class="src-comm">/* equal to ... */</span></li>
<li><a name="a674"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;equal&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a675"></a>                <span class="src-sym">{</span></li>
<li><a name="a676"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;equal&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$ck </span>=&gt; <span class="src-var">$cv</span><span class="src-sym">)</span></li>
<li><a name="a677"></a>                    <span class="src-sym">{</span></li>
<li><a name="a678"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$ck</span><span class="src-sym">] </span>== <span class="src-var">$cv</span><span class="src-sym">) </span><span class="src-var">$return </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a679"></a>                        <span class="src-key">else </span><span class="src-var">$return </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a680"></a>                    <span class="src-sym">}</span></li>
<li><a name="a681"></a>                <span class="src-sym">}</span></li>
<li><a name="a682"></a>&nbsp;</li>
<li><a name="a683"></a>                <span class="src-comm">/* not equal to ... */</span></li>
<li><a name="a684"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;not-equal&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a685"></a>                <span class="src-sym">{</span></li>
<li><a name="a686"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;not-equal&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$ck </span>=&gt; <span class="src-var">$cv</span><span class="src-sym">)</span></li>
<li><a name="a687"></a>                    <span class="src-sym">{</span></li>
<li><a name="a688"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$ck</span><span class="src-sym">] </span>!= <span class="src-var">$cv</span><span class="src-sym">) </span><span class="src-var">$return </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a689"></a>                        <span class="src-key">else </span><span class="src-var">$return </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a690"></a>                    <span class="src-sym">}</span></li>
<li><a name="a691"></a>                <span class="src-sym">}</span></li>
<li><a name="a692"></a>&nbsp;</li>
<li><a name="a693"></a>                <span class="src-comm">/* +++++++++++++++++++++++++++ */</span></li>
<li><a name="a694"></a>                </li>
<li><a name="a695"></a>                <span class="src-comm">/* match to ... */</span></li>
<li><a name="a696"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;match&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a697"></a>                <span class="src-sym">{</span></li>
<li><a name="a698"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;match&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$ck </span>=&gt; <span class="src-var">$cv</span><span class="src-sym">)</span></li>
<li><a name="a699"></a>                    <span class="src-sym">{</span></li>
<li><a name="a700"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#&quot;</span>.<span class="src-var">$cv</span>.<span class="src-str">&quot;#smi&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$ck</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$return </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a701"></a>                        <span class="src-key">else </span><span class="src-var">$return </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a702"></a>                    <span class="src-sym">}</span></li>
<li><a name="a703"></a>                <span class="src-sym">}</span></li>
<li><a name="a704"></a>&nbsp;</li>
<li><a name="a705"></a>                <span class="src-comm">/* not match to ... */</span></li>
<li><a name="a706"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;not-match&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a707"></a>                <span class="src-sym">{</span></li>
<li><a name="a708"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;not-match&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$ck </span>=&gt; <span class="src-var">$cv</span><span class="src-sym">)</span></li>
<li><a name="a709"></a>                    <span class="src-sym">{</span></li>
<li><a name="a710"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#&quot;</span>.<span class="src-var">$cv</span>.<span class="src-str">&quot;#smi&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$ck</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$return </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a711"></a>                        <span class="src-key">else </span><span class="src-var">$return </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a712"></a>                    <span class="src-sym">}</span></li>
<li><a name="a713"></a>                <span class="src-sym">}</span></li>
<li><a name="a714"></a>&nbsp;</li>
<li><a name="a715"></a>                <span class="src-comm">/* +++++++++++++++++++++++++++ */</span></li>
<li><a name="a716"></a>&nbsp;</li>
<li><a name="a717"></a>                <span class="src-comm">/* in-array to ... */</span></li>
<li><a name="a718"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;in-array&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a719"></a>                <span class="src-sym">{</span></li>
<li><a name="a720"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;in-array&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$ck </span>=&gt; <span class="src-var">$cv</span><span class="src-sym">)</span></li>
<li><a name="a721"></a>                    <span class="src-sym">{</span></li>
<li><a name="a722"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$cv</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$ck</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$return </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a723"></a>                        <span class="src-key">else </span><span class="src-var">$return </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a724"></a>                    <span class="src-sym">}</span></li>
<li><a name="a725"></a>                <span class="src-sym">}</span></li>
<li><a name="a726"></a>&nbsp;</li>
<li><a name="a727"></a>                <span class="src-comm">/* not in-array to ... */</span></li>
<li><a name="a728"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;not-in-array&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a729"></a>                <span class="src-sym">{</span></li>
<li><a name="a730"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$conditions</span><span class="src-sym">[</span><span class="src-str">&quot;not-in-array&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$ck </span>=&gt; <span class="src-var">$cv</span><span class="src-sym">)</span></li>
<li><a name="a731"></a>                    <span class="src-sym">{</span></li>
<li><a name="a732"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$cv</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$ck</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$return </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a733"></a>                        <span class="src-key">else </span><span class="src-var">$return </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a734"></a>                    <span class="src-sym">}</span></li>
<li><a name="a735"></a>                <span class="src-sym">}</span></li>
<li><a name="a736"></a>&nbsp;</li>
<li><a name="a737"></a>                <span class="src-comm">/* return result */</span></li>
<li><a name="a738"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$return</span><span class="src-sym">) </span><span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">; </span><span class="src-key">else </span><span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a739"></a>                </li>
<li><a name="a740"></a>            <span class="src-sym">}</span></li>
<li><a name="a741"></a>            <span class="src-key">else </span><span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a742"></a>&nbsp;</li>
<li><a name="a743"></a>        <span class="src-sym">}</span></li>
<li><a name="a744"></a>&nbsp;</li>
<li><a name="a745"></a>&nbsp;</li>
<li><a name="a746"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a747"></a>&nbsp;</li>
<li><a name="a748"></a>&nbsp;</li>
<li><a name="a749"></a>        <span class="src-doc">/**</span></li>
<li><a name="a750"></a><span class="src-doc">         *</span></li>
<li><a name="a751"></a><span class="src-doc">         *</span></li>
<li><a name="a752"></a><span class="src-doc">         *</span></li>
<li><a name="a753"></a><span class="src-doc">         */</span></li>
<li><a name="a754"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_CreateUserData_Array">followUp_CreateUserData_Array</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">)</span></li>
<li><a name="a755"></a>        <span class="src-sym">{</span></li>
<li><a name="a756"></a>&nbsp;</li>
<li><a name="a757"></a>            <span class="src-var">$user_data </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a758"></a>            unset<span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-str">&quot;esiform-post-marker&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a759"></a>&nbsp;</li>
<li><a name="a760"></a>            <span class="src-comm">/* copy post-values to $user_data-array */</span></li>
<li><a name="a761"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a> <span class="src-key">as </span><span class="src-var">$k </span>=&gt; <span class="src-var">$v</span><span class="src-sym">)</span></li>
<li><a name="a762"></a>            <span class="src-sym">{</span></li>
<li><a name="a763"></a>                <span class="src-comm">/* replace vars */</span></li>
<li><a name="a764"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;replace&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a765"></a>                <span class="src-sym">{</span></li>
<li><a name="a766"></a>                    <span class="src-comm">/* replace values by ... */</span></li>
<li><a name="a767"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;replace&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$rk </span>=&gt; <span class="src-var">$rv</span><span class="src-sym">)</span></li>
<li><a name="a768"></a>                    <span class="src-sym">{</span></li>
<li><a name="a769"></a>&nbsp;</li>
<li><a name="a770"></a>                        <span class="src-comm">/* replace by value comparison */</span></li>
<li><a name="a771"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$rk </span>== <span class="src-str">'if-value'</span><span class="src-sym">)</span></li>
<li><a name="a772"></a>                        <span class="src-sym">{</span></li>
<li><a name="a773"></a>                            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$rv </span><span class="src-key">as </span><span class="src-var">$field_id </span>=&gt; <span class="src-var">$condition_array</span><span class="src-sym">)</span></li>
<li><a name="a774"></a>                            <span class="src-sym">{</span></li>
<li><a name="a775"></a>                                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$field_id </span>== <span class="src-var">$k</span><span class="src-sym">)</span></li>
<li><a name="a776"></a>                                <span class="src-sym">{</span></li>
<li><a name="a777"></a>                                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$condition_array </span><span class="src-key">as </span><span class="src-var">$find </span>=&gt; <span class="src-var">$replace_to</span><span class="src-sym">)</span></li>
<li><a name="a778"></a>                                    <span class="src-sym">{</span></li>
<li><a name="a779"></a>                                        <span class="src-comm">/* check if there is regex: match necessary */</span></li>
<li><a name="a780"></a>                                        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$find</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">6</span><span class="src-sym">) </span>== <span class="src-str">'regex:'</span><span class="src-sym">)</span></li>
<li><a name="a781"></a>                                        <span class="src-sym">{</span></li>
<li><a name="a782"></a>                                            <span class="src-var">$find </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;regex:&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$find</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a783"></a>                                            <span class="src-var">$regex </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a784"></a>                                        <span class="src-sym">}</span></li>
<li><a name="a785"></a>                                        <span class="src-key">else </span><span class="src-var">$regex </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a786"></a>                                        </li>
<li><a name="a787"></a>                                        <span class="src-comm">/* check &amp; replace */</span></li>
<li><a name="a788"></a>                                        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$v</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$regex</span><span class="src-sym">)</span></li>
<li><a name="a789"></a>                                        <span class="src-sym">{</span></li>
<li><a name="a790"></a>                                            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$v </span><span class="src-key">as </span><span class="src-var">$mkey </span>=&gt; <span class="src-var">$mval</span><span class="src-sym">) </span><span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#&quot;</span>.<span class="src-var">$find</span>.<span class="src-str">&quot;#smi&quot;</span><span class="src-sym">,</span><span class="src-var">$mval</span><span class="src-sym">)) </span><span class="src-var">$v</span><span class="src-sym">[</span><span class="src-var">$mkey</span><span class="src-sym">] </span>= <span class="src-var">$replace_to</span><span class="src-sym">;</span></li>
<li><a name="a791"></a>                                        <span class="src-sym">}</span></li>
<li><a name="a792"></a>                                        <span class="src-key">elseif</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$v</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">!</span><span class="src-var">$regex </span>&amp;&amp; <a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$find</span><span class="src-sym">,</span><span class="src-var">$v</span><span class="src-sym">)) </span><span class="src-var">$v</span><span class="src-sym">[</span><span class="src-var">$find</span><span class="src-sym">] </span>= <span class="src-var">$replace_to</span><span class="src-sym">;</span></li>
<li><a name="a793"></a>                                        <span class="src-key">elseif</span><span class="src-sym">(</span><span class="src-var">$regex </span>&amp;&amp; <a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#&quot;</span>.<span class="src-var">$find</span>.<span class="src-str">&quot;#smi&quot;</span><span class="src-sym">,</span><span class="src-var">$v</span><span class="src-sym">)) </span><span class="src-var">$v </span>= <span class="src-var">$replace_to</span><span class="src-sym">;</span></li>
<li><a name="a794"></a>                                        <span class="src-key">elseif</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$regex </span>&amp;&amp; <span class="src-var">$v </span>== <span class="src-var">$find</span><span class="src-sym">) </span><span class="src-var">$v </span>= <span class="src-var">$replace_to</span><span class="src-sym">;</span></li>
<li><a name="a795"></a>                                        </li>
<li><a name="a796"></a>                                    <span class="src-sym">}</span></li>
<li><a name="a797"></a>                                <span class="src-sym">}</span></li>
<li><a name="a798"></a>                            <span class="src-sym">}</span></li>
<li><a name="a799"></a>                        <span class="src-sym">}</span></li>
<li><a name="a800"></a>                        </li>
<li><a name="a801"></a>                        <span class="src-comm">/* just replace by key */</span></li>
<li><a name="a802"></a>                        <span class="src-key">elseif</span><span class="src-sym">(</span><span class="src-var">$k </span>== <span class="src-var">$rk</span><span class="src-sym">)</span></li>
<li><a name="a803"></a>                        <span class="src-sym">{</span></li>
<li><a name="a804"></a>                            <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$rv</span><span class="src-sym">))</span></li>
<li><a name="a805"></a>                            <span class="src-sym">{</span></li>
<li><a name="a806"></a>                                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$rv </span><span class="src-key">as </span><span class="src-var">$rk2 </span>=&gt; <span class="src-var">$rv2</span><span class="src-sym">)</span></li>
<li><a name="a807"></a>                                <span class="src-sym">{</span></li>
<li><a name="a808"></a>                                    <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$v</span><span class="src-sym">) </span>&amp;&amp; <a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$rk2</span><span class="src-sym">,</span><span class="src-var">$v</span><span class="src-sym">)) </span><span class="src-var">$v</span><span class="src-sym">[</span><span class="src-var">$rk2</span><span class="src-sym">] </span>= <span class="src-var">$rv2</span><span class="src-sym">;</span></li>
<li><a name="a809"></a>                                <span class="src-sym">}</span></li>
<li><a name="a810"></a>                            <span class="src-sym">}</span></li>
<li><a name="a811"></a>                            <span class="src-key">else </span><span class="src-var">$v </span>= <span class="src-var">$rv</span><span class="src-sym">;</span></li>
<li><a name="a812"></a>                        <span class="src-sym">}</span></li>
<li><a name="a813"></a>&nbsp;</li>
<li><a name="a814"></a>                    <span class="src-sym">}</span></li>
<li><a name="a815"></a>                <span class="src-sym">}</span></li>
<li><a name="a816"></a>                </li>
<li><a name="a817"></a>                <span class="src-comm">/* if there is no delete-array, just create an empty array */        </span></li>
<li><a name="a818"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;delete&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;delete&quot;</span><span class="src-sym">] </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a819"></a>&nbsp;</li>
<li><a name="a820"></a>                <span class="src-comm">/* if field is in delete-array, leave it out of the $user_data-array */</span></li>
<li><a name="a821"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;delete&quot;</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$user_data</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">] </span>= <span class="src-var">$v</span><span class="src-sym">;</span></li>
<li><a name="a822"></a>            <span class="src-sym">}</span></li>
<li><a name="a823"></a>            </li>
<li><a name="a824"></a>            <span class="src-comm">/* add vars if necessary */</span></li>
<li><a name="a825"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;add&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a826"></a>            <span class="src-sym">{</span></li>
<li><a name="a827"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;add&quot;</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$k </span>=&gt; <span class="src-var">$v</span><span class="src-sym">)</span></li>
<li><a name="a828"></a>                <span class="src-sym">{</span></li>
<li><a name="a829"></a>                    </li>
<li><a name="a830"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a831"></a>                    <span class="src-sym">{</span></li>
<li><a name="a832"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$v</span><span class="src-sym">)) </span><span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$v </span><span class="src-key">as </span><span class="src-var">$add_value</span><span class="src-sym">) </span><span class="src-var">$user_data</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-var">$add_value</span><span class="src-sym">] </span>= <span class="src-var">$add_value</span><span class="src-sym">;</span></li>
<li><a name="a833"></a>                        <span class="src-key">else </span><span class="src-var">$user_data</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-var">$v</span><span class="src-sym">] </span>= <span class="src-var">$v</span><span class="src-sym">;</span></li>
<li><a name="a834"></a>                    <span class="src-sym">}</span></li>
<li><a name="a835"></a>                    <span class="src-key">else </span><span class="src-var">$user_data</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">] </span>= <span class="src-var">$v</span><span class="src-sym">;</span></li>
<li><a name="a836"></a>                    </li>
<li><a name="a837"></a>                <span class="src-sym">}</span></li>
<li><a name="a838"></a>            <span class="src-sym">}</span></li>
<li><a name="a839"></a>&nbsp;</li>
<li><a name="a840"></a>            <span class="src-key">return </span><span class="src-var">$user_data</span><span class="src-sym">;</span></li>
<li><a name="a841"></a>&nbsp;</li>
<li><a name="a842"></a>        <span class="src-sym">}</span></li>
<li><a name="a843"></a>        </li>
<li><a name="a844"></a>&nbsp;</li>
<li><a name="a845"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a846"></a>&nbsp;</li>
<li><a name="a847"></a>&nbsp;</li>
<li><a name="a848"></a>        <span class="src-doc">/**</span></li>
<li><a name="a849"></a><span class="src-doc">         *</span></li>
<li><a name="a850"></a><span class="src-doc">         *</span></li>
<li><a name="a851"></a><span class="src-doc">         *</span></li>
<li><a name="a852"></a><span class="src-doc">         */</span></li>
<li><a name="a853"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$data_string</span><span class="src-sym">,</span><span class="src-var">$join_array </span>= <span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a854"></a>        <span class="src-sym">{</span></li>
<li><a name="a855"></a>&nbsp;</li>
<li><a name="a856"></a>            <span class="src-comm">/* replace placeholders */</span></li>
<li><a name="a857"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$user_data </span><span class="src-key">as </span><span class="src-var">$k </span>=&gt; <span class="src-var">$v</span><span class="src-sym">)</span></li>
<li><a name="a858"></a>            <span class="src-sym">{</span></li>
<li><a name="a859"></a>                <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$v</span><span class="src-sym">))</span></li>
<li><a name="a860"></a>                <span class="src-sym">{</span></li>
<li><a name="a861"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$join_array</span><span class="src-sym">) </span><span class="src-var">$data_string </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$v</span><span class="src-sym">,</span><span class="src-var">$data_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a862"></a>                    <span class="src-key">else </span><span class="src-var">$v </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-var">$join_array</span><span class="src-sym">,</span><span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a863"></a>                <span class="src-sym">}</span></li>
<li><a name="a864"></a>                </li>
<li><a name="a865"></a>                <span class="src-var">$data_string </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{&quot;</span>.<span class="src-var">$k</span>.<span class="src-str">&quot;}&quot;</span><span class="src-sym">,</span><span class="src-var">$v</span><span class="src-sym">,</span><span class="src-var">$data_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a866"></a>                <span class="src-var">$data_string </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{&quot;</span>.<span class="src-var">$k</span>.<span class="src-str">&quot;-format}&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_formatString">followUp_formatString</a><span class="src-sym">(</span><span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$data_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a867"></a>                <span class="src-var">$data_string </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{&quot;</span>.<span class="src-var">$k</span>.<span class="src-str">&quot;-id}&quot;</span><span class="src-sym">,</span><span class="src-var">$k</span><span class="src-sym">,</span><span class="src-var">$data_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a868"></a>            <span class="src-sym">}</span></li>
<li><a name="a869"></a>            </li>
<li><a name="a870"></a>            <span class="src-key">return </span><span class="src-var">$data_string</span><span class="src-sym">;</span></li>
<li><a name="a871"></a>&nbsp;</li>
<li><a name="a872"></a>        <span class="src-sym">}</span></li>
<li><a name="a873"></a>        </li>
<li><a name="a874"></a>        </li>
<li><a name="a875"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a876"></a>&nbsp;</li>
<li><a name="a877"></a>&nbsp;</li>
<li><a name="a878"></a>        <span class="src-doc">/**</span></li>
<li><a name="a879"></a><span class="src-doc">         *</span></li>
<li><a name="a880"></a><span class="src-doc">         *</span></li>
<li><a name="a881"></a><span class="src-doc">         *</span></li>
<li><a name="a882"></a><span class="src-doc">         */</span></li>
<li><a name="a883"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_autoText">followUp_autoText</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$spaces </span>= <span class="src-id">null</span><span class="src-sym">,</span><span class="src-var">$list_sign </span>= <span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a884"></a>        <span class="src-sym">{</span></li>
<li><a name="a885"></a>    </li>
<li><a name="a886"></a>            <span class="src-var">$auto_text </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a887"></a>            <span class="src-var">$cache_spaces </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a888"></a>            <span class="src-var">$default_tab </span>= <span class="src-str">'  '</span><span class="src-sym">;</span></li>
<li><a name="a889"></a>                        </li>
<li><a name="a890"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$user_data </span><span class="src-key">as </span><span class="src-var">$uk </span>=&gt; <span class="src-var">$uv</span><span class="src-sym">)</span></li>
<li><a name="a891"></a>            <span class="src-sym">{</span></li>
<li><a name="a892"></a>                </li>
<li><a name="a893"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$uk </span>!= <span class="src-str">&quot;esiform-post-marker&quot;</span><span class="src-sym">)</span></li>
<li><a name="a894"></a>                <span class="src-sym">{</span></li>
<li><a name="a895"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$uv</span><span class="src-sym">)) </span><span class="src-var">$text </span>= <span class="src-var">$spaces</span>.<span class="src-str">&quot;{&quot;</span>.<span class="src-var">$uk</span>.<span class="src-str">&quot;-id}:\r\n&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_autoText">followUp_autoText</a><span class="src-sym">(</span><span class="src-var">$uv</span><span class="src-sym">,</span><span class="src-var">$spaces</span>.<span class="src-str">'    '</span><span class="src-sym">,</span><span class="src-str">'=&gt; '</span><span class="src-sym">)</span>.<span class="src-str">&quot;\r\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a896"></a>                    <span class="src-key">else</span></li>
<li><a name="a897"></a>                    <span class="src-sym">{</span></li>
<li><a name="a898"></a>                        <span class="src-var">$cache_spaces</span><span class="src-sym">[</span><span class="src-var">$uk</span><span class="src-sym">] </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$uk</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a899"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$list_sign</span><span class="src-sym">) </span><span class="src-var">$text </span>= <span class="src-var">$list_sign</span>.<span class="src-str">'{'</span>.<span class="src-var">$uk</span>.<span class="src-str">'-id}:{cache-spaces-'</span>.<span class="src-var">$uk</span>.<span class="src-str">'}{'</span>.<span class="src-var">$uk</span>.<span class="src-str">'}'</span><span class="src-sym">;</span></li>
<li><a name="a900"></a>                        <span class="src-key">else </span><span class="src-var">$text </span>= <span class="src-var">$list_sign</span>.<span class="src-str">'{'</span>.<span class="src-var">$uk</span>.<span class="src-str">'}'</span><span class="src-sym">;</span></li>
<li><a name="a901"></a>                    <span class="src-sym">}</span></li>
<li><a name="a902"></a>                    </li>
<li><a name="a903"></a>                    <span class="src-var">$auto_text</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$spaces</span>.<span class="src-var">$text</span><span class="src-sym">;</span></li>
<li><a name="a904"></a>                <span class="src-sym">}</span></li>
<li><a name="a905"></a>            <span class="src-sym">}</span></li>
<li><a name="a906"></a>            </li>
<li><a name="a907"></a>            <span class="src-var">$finished_text </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;\r\n&quot;</span><span class="src-sym">,</span><span class="src-var">$auto_text</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a908"></a>            </li>
<li><a name="a909"></a>            <span class="src-comm">/* tabin text */</span></li>
<li><a name="a910"></a>            <a href="http://www.php.net/arsort">arsort</a><span class="src-sym">(</span><span class="src-var">$cache_spaces</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a911"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$cache_spaces </span><span class="src-key">as </span><span class="src-var">$uk </span>=&gt; <span class="src-var">$uv</span><span class="src-sym">)</span></li>
<li><a name="a912"></a>            <span class="src-sym">{</span></li>
<li><a name="a913"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$most_chars</span><span class="src-sym">)</span></li>
<li><a name="a914"></a>                <span class="src-sym">{</span></li>
<li><a name="a915"></a>                    <span class="src-var">$most_chars </span>= <span class="src-var">$uv</span><span class="src-sym">;</span></li>
<li><a name="a916"></a>                    <span class="src-var">$finished_text </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">'{cache-spaces-'</span>.<span class="src-var">$uk</span>.<span class="src-str">'}'</span><span class="src-sym">,</span><span class="src-var">$default_tab</span><span class="src-sym">,</span><span class="src-var">$finished_text</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a917"></a>                <span class="src-sym">}</span></li>
<li><a name="a918"></a>                <span class="src-key">else </span><span class="src-var">$finished_text </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">'{cache-spaces-'</span>.<span class="src-var">$uk</span>.<span class="src-str">'}'</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodreturn_textSpaces">return_textSpaces</a><span class="src-sym">(</span><span class="src-var">$most_chars</span>-<span class="src-var">$uv</span><span class="src-sym">)</span>.<span class="src-var">$default_tab</span><span class="src-sym">,</span><span class="src-var">$finished_text</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a919"></a>            <span class="src-sym">}</span></li>
<li><a name="a920"></a>            </li>
<li><a name="a921"></a>            <span class="src-key">return </span><span class="src-var">$finished_text</span><span class="src-sym">;</span></li>
<li><a name="a922"></a>            </li>
<li><a name="a923"></a>        <span class="src-sym">}</span></li>
<li><a name="a924"></a>        </li>
<li><a name="a925"></a>&nbsp;</li>
<li><a name="a926"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a927"></a>&nbsp;</li>
<li><a name="a928"></a>&nbsp;</li>
<li><a name="a929"></a>        <span class="src-doc">/**</span></li>
<li><a name="a930"></a><span class="src-doc">         *</span></li>
<li><a name="a931"></a><span class="src-doc">         *</span></li>
<li><a name="a932"></a><span class="src-doc">         *</span></li>
<li><a name="a933"></a><span class="src-doc">         */</span></li>
<li><a name="a934"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_Mail_replaceSenderTags">followUp_Mail_replaceSenderTags</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$sender_array</span><span class="src-sym">)</span></li>
<li><a name="a935"></a>        <span class="src-sym">{</span></li>
<li><a name="a936"></a>            <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$sender_array</span><span class="src-sym">))</span></li>
<li><a name="a937"></a>            <span class="src-sym">{</span></li>
<li><a name="a938"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$sender_array </span><span class="src-key">as </span><span class="src-var">$k </span>=&gt; <span class="src-var">$v</span><span class="src-sym">) </span><span class="src-var">$sender_array</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a939"></a>                <span class="src-key">return </span><span class="src-var">$sender_array</span><span class="src-sym">;</span></li>
<li><a name="a940"></a>            <span class="src-sym">}</span></li>
<li><a name="a941"></a>        <span class="src-sym">}</span></li>
<li><a name="a942"></a>        </li>
<li><a name="a943"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a944"></a>&nbsp;</li>
<li><a name="a945"></a>&nbsp;</li>
<li><a name="a946"></a>        <span class="src-doc">/**</span></li>
<li><a name="a947"></a><span class="src-doc">         *</span></li>
<li><a name="a948"></a><span class="src-doc">         *</span></li>
<li><a name="a949"></a><span class="src-doc">         *</span></li>
<li><a name="a950"></a><span class="src-doc">         */</span></li>
<li><a name="a951"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_Mail">followUp_Mail</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">,</span><span class="src-var">$user_data</span><span class="src-sym">)</span></li>
<li><a name="a952"></a>        <span class="src-sym">{</span></li>
<li><a name="a953"></a>            </li>
<li><a name="a954"></a>            <span class="src-comm">/* load 3rd-party classes */</span></li>
<li><a name="a955"></a>            <span class="src-inc">require_once</span><span class="src-sym">(</span><span class="src-str">&quot;3rd-party/phpmailer/class.phpmailer.php&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a956"></a>            <span class="src-inc">require_once</span><span class="src-sym">(</span><span class="src-str">&quot;3rd-party/send_mail.php&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a957"></a>            <span class="src-var">$mailer </span>= <span class="src-key">new </span><span class="src-id">PHPMailer</span><span class="src-sym">;</span></li>
<li><a name="a958"></a>&nbsp;</li>
<li><a name="a959"></a>            <span class="src-comm">/* get bodies */</span></li>
<li><a name="a960"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;text&quot;</span><span class="src-sym">] </span>&amp;&amp; <a href="http://www.php.net/is_file">is_file</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;text&quot;</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;text&quot;</span><span class="src-sym">] </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><a href="http://www.php.net/file">file</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;text&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a961"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;html&quot;</span><span class="src-sym">] </span>&amp;&amp; <a href="http://www.php.net/is_file">is_file</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;html&quot;</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;html&quot;</span><span class="src-sym">] </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><a href="http://www.php.net/file">file</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;html&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a962"></a>&nbsp;</li>
<li><a name="a963"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">&quot;text&quot; </span>=&gt; <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;text&quot;</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-str">&quot;html&quot; </span>=&gt; <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;html&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-key">as </span><span class="src-var">$dk </span>=&gt; <span class="src-var">$dv</span><span class="src-sym">)</span></li>
<li><a name="a964"></a>            <span class="src-sym">{</span></li>
<li><a name="a965"></a>                <span class="src-comm">/* set auto-body */</span></li>
<li><a name="a966"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-var">$dk</span><span class="src-sym">] </span>== <span class="src-str">':auto' </span>|| <span class="src-var">$dk </span>== <span class="src-str">'text' </span>&amp;&amp; <span class="src-sym">!</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-var">$dk</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-var">$dk</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_autoText">followUp_autoText</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a967"></a>                </li>
<li><a name="a968"></a>                <span class="src-comm">/* replace placeholders */</span></li>
<li><a name="a969"></a>                <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-var">$dk</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-var">$dk</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a970"></a>            <span class="src-sym">}</span></li>
<li><a name="a971"></a>            </li>
<li><a name="a972"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;attachments&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;attachments&quot;</span><span class="src-sym">] </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a973"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;embedded&quot;</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;embedded&quot;</span><span class="src-sym">] </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a974"></a>&nbsp;</li>
<li><a name="a975"></a>            <span class="src-comm">/* send e-mail */</span></li>
<li><a name="a976"></a>            <span class="src-var">$send_users </span>= <span class="src-id">Send_Email</span><span class="src-sym">(</span></li>
<li><a name="a977"></a>                <span class="src-key">array</span><span class="src-sym">(</span></li>
<li><a name="a978"></a>                    <span class="src-str">&quot;to&quot;                    </span>=&gt; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_Mail_replaceSenderTags">followUp_Mail_replaceSenderTags</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;to&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a979"></a>                    <span class="src-str">&quot;cc&quot;                    </span>=&gt; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_Mail_replaceSenderTags">followUp_Mail_replaceSenderTags</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;cc&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a980"></a>                    <span class="src-str">&quot;bcc&quot;                    </span>=&gt; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_Mail_replaceSenderTags">followUp_Mail_replaceSenderTags</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;bcc&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a981"></a>                    <span class="src-str">&quot;from&quot;                </span>=&gt; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;from&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a982"></a>                    <span class="src-str">&quot;from-name&quot;            </span>=&gt; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;from-name&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a983"></a>                    <span class="src-str">&quot;subject&quot;            </span>=&gt; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;subject&quot;</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a984"></a>                    <span class="src-str">&quot;text&quot;                </span>=&gt; <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;text&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a985"></a>                    <span class="src-str">&quot;html&quot;                </span>=&gt; <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;html&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a986"></a>                    <span class="src-str">&quot;attachments&quot;        </span>=&gt; <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;attachments&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a987"></a>                    <span class="src-str">&quot;embedded&quot;            </span>=&gt; <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;embedded&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a988"></a>                <span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a989"></a>                <span class="src-var">$mailer</span></li>
<li><a name="a990"></a>            <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a991"></a>&nbsp;</li>
<li><a name="a992"></a>            <span class="src-comm">/* fallback */</span></li>
<li><a name="a993"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$send_users</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_fallback">followUp_fallback</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a994"></a>&nbsp;</li>
<li><a name="a995"></a>        <span class="src-sym">}</span></li>
<li><a name="a996"></a>&nbsp;</li>
<li><a name="a997"></a>&nbsp;</li>
<li><a name="a998"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a999"></a>&nbsp;</li>
<li><a name="a1000"></a>&nbsp;</li>
<li><a name="a1001"></a>        <span class="src-doc">/**</span></li>
<li><a name="a1002"></a><span class="src-doc">         *</span></li>
<li><a name="a1003"></a><span class="src-doc">         *</span></li>
<li><a name="a1004"></a><span class="src-doc">         *</span></li>
<li><a name="a1005"></a><span class="src-doc">         */</span></li>
<li><a name="a1006"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_Socket">followUp_Socket</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">,</span><span class="src-var">$user_data</span><span class="src-sym">)</span></li>
<li><a name="a1007"></a>        <span class="src-sym">{</span></li>
<li><a name="a1008"></a>&nbsp;</li>
<li><a name="a1009"></a>            <span class="src-comm">/* format array-values */</span></li>
<li><a name="a1010"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$user_data </span><span class="src-key">as </span><span class="src-var">$k </span>=&gt; <span class="src-var">$v</span><span class="src-sym">)</span></li>
<li><a name="a1011"></a>            <span class="src-sym">{</span></li>
<li><a name="a1012"></a>                <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$v</span><span class="src-sym">)) </span><span class="src-var">$user_data</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">] </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;,&quot;</span><span class="src-sym">,</span><span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1013"></a>            <span class="src-sym">}</span></li>
<li><a name="a1014"></a>            </li>
<li><a name="a1015"></a>            <span class="src-comm">/* send http-request */</span></li>
<li><a name="a1016"></a>            <span class="src-var">$return </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_socketConnector">followUp_socketConnector</a><span class="src-sym">(</span></li>
<li><a name="a1017"></a>                <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;host&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a1018"></a>                <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;port&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a1019"></a>                <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;method&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a1020"></a>                <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;path&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a1021"></a>                <span class="src-var">$user_data</span></li>
<li><a name="a1022"></a>            <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1023"></a>&nbsp;</li>
<li><a name="a1024"></a>            <span class="src-comm">/* handle returns */</span></li>
<li><a name="a1025"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$return</span><span class="src-sym">)</span></li>
<li><a name="a1026"></a>            <span class="src-sym">{</span></li>
<li><a name="a1027"></a>&nbsp;</li>
<li><a name="a1028"></a>                <span class="src-comm">/*</span></li>
<li><a name="a1029"></a><span class="src-comm">                    Catch &quot;Content-xreturn&quot;-values</span></li>
<li><a name="a1030"></a>    </li>
<li><a name="a1031"></a><span class="src-comm">                    A return has to be formated like this:</span></li>
<li><a name="a1032"></a><span class="src-comm">                    Content-xreturn: &lt;field-id:field-value&gt;&lt;field-id:field-value&gt; ...</span></li>
<li><a name="a1033"></a><span class="src-comm">                */</span></li>
<li><a name="a1034"></a>&nbsp;</li>
<li><a name="a1035"></a>                <a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#Content-xreturn:\s(.*)\s#&quot;</span><span class="src-sym">,</span><span class="src-var">$return</span><span class="src-sym">,</span><span class="src-var">$all_found_return_values</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1036"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$all_found_return_values</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a1037"></a>                <span class="src-sym">{</span></li>
<li><a name="a1038"></a>                    <a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">&quot;#&lt;(.*?):(.*?)&gt;#&quot;</span><span class="src-sym">,</span><span class="src-var">$all_found_return_values</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$single_return_values</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1039"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$single_return_values</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$id </span>=&gt; <span class="src-var">$tag</span><span class="src-sym">)</span></li>
<li><a name="a1040"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1041"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$tag</span><span class="src-sym">] </span>= <span class="src-var">$single_return_values</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-var">$id</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1042"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1043"></a>                <span class="src-sym">}</span></li>
<li><a name="a1044"></a>                </li>
<li><a name="a1045"></a>            <span class="src-sym">}</span></li>
<li><a name="a1046"></a>            </li>
<li><a name="a1047"></a>            <span class="src-comm">/* fallback */</span></li>
<li><a name="a1048"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$return</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_fallback">followUp_fallback</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1049"></a>&nbsp;</li>
<li><a name="a1050"></a>        <span class="src-sym">}</span></li>
<li><a name="a1051"></a>&nbsp;</li>
<li><a name="a1052"></a>&nbsp;</li>
<li><a name="a1053"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a1054"></a>&nbsp;</li>
<li><a name="a1055"></a>&nbsp;</li>
<li><a name="a1056"></a>        <span class="src-doc">/**</span></li>
<li><a name="a1057"></a><span class="src-doc">         *</span></li>
<li><a name="a1058"></a><span class="src-doc">         *</span></li>
<li><a name="a1059"></a><span class="src-doc">         *</span></li>
<li><a name="a1060"></a><span class="src-doc">         */</span></li>
<li><a name="a1061"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_Mysql">followUp_Mysql</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">,</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$follow_up_name</span><span class="src-sym">)</span></li>
<li><a name="a1062"></a>        <span class="src-sym">{</span></li>
<li><a name="a1063"></a>&nbsp;</li>
<li><a name="a1064"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$dbh </span>= <span class="src-id">mysql_connect</span><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;host&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;user&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;password&quot;</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1065"></a>            <span class="src-sym">{</span></li>
<li><a name="a1066"></a>&nbsp;</li>
<li><a name="a1067"></a>                <span class="src-var">$query </span>= <span class="src-str">&quot;use &quot;</span>.<span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;name&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1068"></a>                <span class="src-id">mysql_query</span><span class="src-sym">(</span><span class="src-var">$query</span><span class="src-sym">,</span><span class="src-var">$dbh</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1069"></a>    </li>
<li><a name="a1070"></a>                <span class="src-comm">/* replace placeholders */</span></li>
<li><a name="a1071"></a>                <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;query&quot;</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;query&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-str">','</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1072"></a>&nbsp;</li>
<li><a name="a1073"></a>                <span class="src-comm">/* check for errors */</span></li>
<li><a name="a1074"></a>                <span class="src-var">$mysql_error </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a1075"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">mysql_error</span><span class="src-sym">(</span><span class="src-sym">)) </span><span class="src-id">mysql_query</span><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;query&quot;</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$dbh</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1076"></a>                <span class="src-key">else </span><span class="src-var">$mysql_error </span>= <span class="src-id">mysql_error</span><span class="src-sym">(</span><span class="src-sym">)</span>.<span class="src-str">&quot;\nQuery: &amp;lt;&quot;</span>.<span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;query&quot;</span><span class="src-sym">]</span>.<span class="src-str">&quot;&amp;gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1077"></a>&nbsp;</li>
<li><a name="a1078"></a>                <span class="src-comm">/* set the last inserted id */</span></li>
<li><a name="a1079"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-id">mysql_insert_id</span><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a1080"></a>                <span class="src-sym">{</span></li>
<li><a name="a1081"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#var$post_values">post_values</a><span class="src-sym">[</span><span class="src-var">$follow_up_name</span>.<span class="src-str">&quot;-id&quot;</span><span class="src-sym">] </span>= <span class="src-id">mysql_insert_id</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1082"></a>                <span class="src-sym">}</span></li>
<li><a name="a1083"></a>&nbsp;</li>
<li><a name="a1084"></a>                <span class="src-id">mysql_close</span><span class="src-sym">(</span><span class="src-var">$dbh</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1085"></a>    </li>
<li><a name="a1086"></a>                <span class="src-comm">/* fallback */</span></li>
<li><a name="a1087"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$mysql_error</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_fallback">followUp_fallback</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1088"></a>                </li>
<li><a name="a1089"></a>            <span class="src-sym">}</span></li>
<li><a name="a1090"></a>&nbsp;</li>
<li><a name="a1091"></a>        <span class="src-sym">}</span></li>
<li><a name="a1092"></a>&nbsp;</li>
<li><a name="a1093"></a>&nbsp;</li>
<li><a name="a1094"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a1095"></a>&nbsp;</li>
<li><a name="a1096"></a>&nbsp;</li>
<li><a name="a1097"></a>        <span class="src-doc">/**</span></li>
<li><a name="a1098"></a><span class="src-doc">         *</span></li>
<li><a name="a1099"></a><span class="src-doc">         *</span></li>
<li><a name="a1100"></a><span class="src-doc">         *</span></li>
<li><a name="a1101"></a><span class="src-doc">         */</span></li>
<li><a name="a1102"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_File">followUp_File</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">,</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$file_error </span>= <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a1103"></a>        <span class="src-sym">{</span></li>
<li><a name="a1104"></a>&nbsp;</li>
<li><a name="a1105"></a>            <span class="src-var">$text </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_autoText">followUp_autoText</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1106"></a>            <span class="src-var">$text </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$text</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1107"></a>            </li>
<li><a name="a1108"></a>            <span class="src-var">$full_path </span>= <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;path&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1109"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$full_path</span><span class="src-sym">) </span><span class="src-var">$full_path </span>= <span class="src-str">'.'</span><span class="src-sym">;</span></li>
<li><a name="a1110"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">#/$#</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$full_path</span><span class="src-sym">)) </span><span class="src-var">$full_path </span>.= <span class="src-str">&quot;/&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1111"></a>&nbsp;</li>
<li><a name="a1112"></a>            <span class="src-var">$full_path </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;%session&quot;</span><span class="src-sym">,</span><a href="http://www.php.net/session_id">session_id</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$full_path</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1113"></a>            <span class="src-var">$full_path </span>= <a href="http://www.php.net/strftime">strftime</a><span class="src-sym">(</span><span class="src-var">$full_path</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1114"></a>            <span class="src-var">$full_path </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$full_path</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1115"></a>&nbsp;</li>
<li><a name="a1116"></a>            <span class="src-var">$file_name </span>= <span class="src-var">$data</span><span class="src-sym">[</span><span class="src-str">&quot;file-name&quot;</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1117"></a>            <span class="src-var">$file_name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;%session&quot;</span><span class="src-sym">,</span><a href="http://www.php.net/session_id">session_id</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$file_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1118"></a>            <span class="src-var">$file_name </span>= <a href="http://www.php.net/strftime">strftime</a><span class="src-sym">(</span><span class="src-var">$file_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1119"></a>            <span class="src-var">$file_name </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_tagReplacements">followUp_tagReplacements</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$file_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1120"></a>            </li>
<li><a name="a1121"></a>            <span class="src-comm">/* check and create_ path if necessary */</span></li>
<li><a name="a1122"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">&quot;/&quot;</span><span class="src-sym">,</span><span class="src-var">$full_path</span><span class="src-sym">) </span><span class="src-key">as </span><span class="src-var">$path</span><span class="src-sym">)</span></li>
<li><a name="a1123"></a>            <span class="src-sym">{</span></li>
<li><a name="a1124"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$path</span><span class="src-sym">)</span></li>
<li><a name="a1125"></a>                <span class="src-sym">{</span></li>
<li><a name="a1126"></a>                    <span class="src-var">$finished_path</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$path</span><span class="src-sym">;</span></li>
<li><a name="a1127"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/file_exists">file_exists</a><span class="src-sym">(</span><a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;/&quot;</span><span class="src-sym">,</span><span class="src-var">$finished_path</span><span class="src-sym">))) </span><a href="http://www.php.net/mkdir">mkdir</a><span class="src-sym">(</span><a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;/&quot;</span><span class="src-sym">,</span><span class="src-var">$finished_path</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1128"></a>                <span class="src-sym">}</span></li>
<li><a name="a1129"></a>            <span class="src-sym">}</span></li>
<li><a name="a1130"></a>            </li>
<li><a name="a1131"></a>            <span class="src-comm">/* write file */</span></li>
<li><a name="a1132"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$fh </span>= <a href="http://www.php.net/fopen">fopen</a><span class="src-sym">(</span><span class="src-var">$full_path</span>.<span class="src-var">$file_name</span><span class="src-sym">,</span><span class="src-str">&quot;w&quot;</span><span class="src-sym">))</span></li>
<li><a name="a1133"></a>            <span class="src-sym">{</span></li>
<li><a name="a1134"></a>                <a href="http://www.php.net/fwrite">fwrite</a><span class="src-sym">(</span><span class="src-var">$fh</span><span class="src-sym">,</span><span class="src-var">$text</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1135"></a>                <a href="http://www.php.net/fclose">fclose</a><span class="src-sym">(</span><span class="src-var">$fh</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1136"></a>            <span class="src-sym">}</span></li>
<li><a name="a1137"></a>            </li>
<li><a name="a1138"></a>            <span class="src-comm">/* fallback */</span></li>
<li><a name="a1139"></a>            <span class="src-key">else </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_fallback">followUp_fallback</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$file_error</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1140"></a>                        </li>
<li><a name="a1141"></a>        <span class="src-sym">}</span></li>
<li><a name="a1142"></a>&nbsp;</li>
<li><a name="a1143"></a>&nbsp;</li>
<li><a name="a1144"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a1145"></a>&nbsp;</li>
<li><a name="a1146"></a>&nbsp;</li>
<li><a name="a1147"></a>        <span class="src-doc">/**</span></li>
<li><a name="a1148"></a><span class="src-doc">         *</span></li>
<li><a name="a1149"></a><span class="src-doc">         *</span></li>
<li><a name="a1150"></a><span class="src-doc">         *</span></li>
<li><a name="a1151"></a><span class="src-doc">         */</span></li>
<li><a name="a1152"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_fallback">followUp_fallback</a><span class="src-sym">(</span><span class="src-var">$user_data</span><span class="src-sym">,</span><span class="src-var">$file_error </span>= <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a1153"></a>        <span class="src-sym">{</span></li>
<li><a name="a1154"></a>&nbsp;</li>
<li><a name="a1155"></a>            <span class="src-var">$data </span>= <span class="src-key">array</span><span class="src-sym">(</span></li>
<li><a name="a1156"></a>                <span class="src-str">&quot;path&quot;         </span>=&gt; <span class="src-str">&quot;fallback&quot;</span><span class="src-sym">,</span></li>
<li><a name="a1157"></a>                <span class="src-str">&quot;file-name&quot;    </span>=&gt; <span class="src-str">&quot;%y%m%d-%H%M-%session.txt&quot;</span><span class="src-sym">,</span></li>
<li><a name="a1158"></a>            <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1159"></a>            </li>
<li><a name="a1160"></a>            <span class="src-comm">/* fallback does only sense when there is no file error ... */</span></li>
<li><a name="a1161"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$file_error </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../esiform/esiform.html#methodfollowUp_File">followUp_File</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">,</span><span class="src-var">$user_data</span><span class="src-sym">,</span>++<span class="src-var">$file_error</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1162"></a>&nbsp;</li>
<li><a name="a1163"></a>        <span class="src-sym">}</span></li>
<li><a name="a1164"></a>        </li>
<li><a name="a1165"></a>&nbsp;</li>
<li><a name="a1166"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a1167"></a>&nbsp;</li>
<li><a name="a1168"></a>        </li>
<li><a name="a1169"></a>        <span class="src-doc">/**</span></li>
<li><a name="a1170"></a><span class="src-doc">         *</span></li>
<li><a name="a1171"></a><span class="src-doc">         * connect via socket</span></li>
<li><a name="a1172"></a><span class="src-doc">         *</span></li>
<li><a name="a1173"></a><span class="src-doc">         */</span></li>
<li><a name="a1174"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_socketConnector">followUp_socketConnector</a><span class="src-sym">(</span><span class="src-var">$host</span><span class="src-sym">, </span><span class="src-var">$port</span><span class="src-sym">, </span><span class="src-var">$method</span><span class="src-sym">, </span><span class="src-var">$path</span><span class="src-sym">, </span><span class="src-var">$parameter</span><span class="src-sym">)</span></li>
<li><a name="a1175"></a>        <span class="src-sym">{</span></li>
<li><a name="a1176"></a>        </li>
<li><a name="a1177"></a>            <span class="src-comm">/* connect */</span></li>
<li><a name="a1178"></a>            <span class="src-var">$fp </span>= <span class="src-sym">@</span><a href="http://www.php.net/fsockopen">fsockopen</a><span class="src-sym">(</span><span class="src-var">$host</span><span class="src-sym">,</span><span class="src-var">$port</span><span class="src-sym">,</span><span class="src-var">$errno</span><span class="src-sym">,</span><span class="src-var">$errstr</span><span class="src-sym">,</span><span class="src-num">5</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1179"></a>            </li>
<li><a name="a1180"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">)</span></li>
<li><a name="a1181"></a>            <span class="src-sym">{</span></li>
<li><a name="a1182"></a>            </li>
<li><a name="a1183"></a>                <span class="src-comm">/* format parameter */</span></li>
<li><a name="a1184"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$parameter </span><span class="src-key">as </span><span class="src-var">$k </span>=&gt; <span class="src-var">$v</span><span class="src-sym">) </span><span class="src-var">$finished_parameter</span><span class="src-sym">[</span><span class="src-sym">] </span>= <a href="http://www.php.net/urlencode">urlencode</a><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">)</span>.<span class="src-str">&quot;=&quot;</span>.<a href="http://www.php.net/urlencode">urlencode</a><span class="src-sym">(</span><span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1185"></a>                <span class="src-var">$parameter </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;&quot;</span><span class="src-sym">,</span><span class="src-var">$finished_parameter</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1186"></a>                </li>
<li><a name="a1187"></a>                <span class="src-comm">/* if ssl */</span></li>
<li><a name="a1188"></a>                <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$host</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">3</span><span class="src-sym">) </span>== <span class="src-str">&quot;ssl&quot;</span><span class="src-sym">) </span><span class="src-var">$path </span>= <span class="src-str">'https://'</span>.<span class="src-var">$path</span><span class="src-sym">;</span></li>
<li><a name="a1189"></a>                </li>
<li><a name="a1190"></a>                <span class="src-var">$method </span>= <a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$method</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1191"></a>                </li>
<li><a name="a1192"></a>                <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$method </span>== <span class="src-str">&quot;GET&quot;</span><span class="src-sym">) </span><span class="src-var">$path </span>.= <span class="src-str">'?'</span>.<span class="src-var">$parameter</span><span class="src-sym">;</span></li>
<li><a name="a1193"></a>                </li>
<li><a name="a1194"></a>                <a href="http://www.php.net/fputs">fputs</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">, </span><span class="src-var">$method</span>.<span class="src-str">&quot; &quot;</span>.<span class="src-var">$path</span>.<span class="src-str">&quot; HTTP/1.1\r\n&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1195"></a>                <a href="http://www.php.net/fputs">fputs</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">, </span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Host</span>: <span class="src-var">$host</span>\r\n</span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1196"></a>               <a href="http://www.php.net/fputs">fputs</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">, </span><span class="src-str">&quot;User-Agent: esiform\r\n&quot;</span><span class="src-sym">)</span><span class="src-sym">; </span></li>
<li><a name="a1197"></a>                <a href="http://www.php.net/fputs">fputs</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">, </span><span class="src-str">&quot;Content-type: application/x-www-form-urlencoded\r\n&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1198"></a>                <a href="http://www.php.net/fputs">fputs</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">, </span><span class="src-str">&quot;Content-length: &quot;</span>.<a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$parameter</span><span class="src-sym">)</span>.<span class="src-str">&quot;\r\n&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1199"></a>                <a href="http://www.php.net/fputs">fputs</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">, </span><span class="src-str">&quot;Connection: close\r\n&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1200"></a>                <a href="http://www.php.net/fputs">fputs</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">, </span><span class="src-str">&quot;\r\n&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1201"></a>    </li>
<li><a name="a1202"></a>                <a href="http://www.php.net/fputs">fputs</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">, </span><span class="src-str">&quot;</span><span class="src-str"><span class="src-var">$parameter</span>\r\n</span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1203"></a>                </li>
<li><a name="a1204"></a>                <span class="src-comm">/* cache return */</span></li>
<li><a name="a1205"></a>                <span class="src-key">while</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$end</span><span class="src-sym">)</span></li>
<li><a name="a1206"></a>                <span class="src-sym">{</span></li>
<li><a name="a1207"></a>                    <span class="src-var">$line </span>= <a href="http://www.php.net/fgets">fgets</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">, </span><span class="src-num">4096</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1208"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/feof">feof</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">) </span>|| <a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#^\s#&quot;</span><span class="src-sym">,</span><span class="src-var">$line</span><span class="src-sym">)) </span><span class="src-var">$end </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1209"></a>                    <span class="src-key">else </span><span class="src-var">$res </span>.= <span class="src-var">$line</span><span class="src-sym">;</span></li>
<li><a name="a1210"></a>                <span class="src-sym">}</span></li>
<li><a name="a1211"></a>                </li>
<li><a name="a1212"></a>                <a href="http://www.php.net/fclose">fclose</a><span class="src-sym">(</span><span class="src-var">$fp</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1213"></a>                <span class="src-key">return </span><span class="src-var">$res</span><span class="src-sym">;</span></li>
<li><a name="a1214"></a>            </li>
<li><a name="a1215"></a>            <span class="src-sym">}</span></li>
<li><a name="a1216"></a>            <span class="src-key">else </span><span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a1217"></a>        </li>
<li><a name="a1218"></a>        <span class="src-sym">}</span></li>
<li><a name="a1219"></a>&nbsp;</li>
<li><a name="a1220"></a>&nbsp;</li>
<li><a name="a1221"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a1222"></a>        </li>
<li><a name="a1223"></a>        </li>
<li><a name="a1224"></a>        <span class="src-doc">/**</span></li>
<li><a name="a1225"></a><span class="src-doc">         *</span></li>
<li><a name="a1226"></a><span class="src-doc">         * format strings to upper- / lowercase</span></li>
<li><a name="a1227"></a><span class="src-doc">         *</span></li>
<li><a name="a1228"></a><span class="src-doc">         */</span></li>
<li><a name="a1229"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodfollowUp_formatString">followUp_formatString</a><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">)</span></li>
<li><a name="a1230"></a>        <span class="src-sym">{</span></li>
<li><a name="a1231"></a>            </li>
<li><a name="a1232"></a>            <span class="src-var">$string </span>= <a href="http://www.php.net/strtolower">strtolower</a><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1233"></a>            <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;#\@#&quot;</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">))</span></li>
<li><a name="a1234"></a>            <span class="src-sym">{</span></li>
<li><a name="a1235"></a>    </li>
<li><a name="a1236"></a>                <span class="src-comm">/* Bei Leerzeichen aufsplitten */</span></li>
<li><a name="a1237"></a>                <span class="src-var">$split_space </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">&quot; &quot;</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1238"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$split_space </span><span class="src-key">as </span><span class="src-var">$Key </span>=&gt; <span class="src-var">$Val</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$split_space</span><span class="src-sym">[</span><span class="src-var">$Key</span><span class="src-sym">] </span>= <a href="http://www.php.net/ucfirst">ucfirst</a><span class="src-sym">(</span><span class="src-var">$Val</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a1239"></a>                <span class="src-var">$string </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot; &quot;</span><span class="src-sym">,</span><span class="src-var">$split_space</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1240"></a>    </li>
<li><a name="a1241"></a>                <span class="src-comm">/* Bei Bindestrich aufsplitten */</span></li>
<li><a name="a1242"></a>                <span class="src-var">$split_line </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1243"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$split_line </span><span class="src-key">as </span><span class="src-var">$Key </span>=&gt; <span class="src-var">$Val</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$split_line</span><span class="src-sym">[</span><span class="src-var">$Key</span><span class="src-sym">] </span>= <a href="http://www.php.net/ucfirst">ucfirst</a><span class="src-sym">(</span><span class="src-var">$Val</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a1244"></a>                <span class="src-var">$string </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">,</span><span class="src-var">$split_line</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1245"></a>        </li>
<li><a name="a1246"></a>                <span class="src-comm">/* Bei Punkten aufsplitten */</span></li>
<li><a name="a1247"></a>                <span class="src-var">$split_dot </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">&quot;\.&quot;</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1248"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$split_dot </span><span class="src-key">as </span><span class="src-var">$Key </span>=&gt; <span class="src-var">$Val</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$split_dot</span><span class="src-sym">[</span><span class="src-var">$Key</span><span class="src-sym">] </span>= <a href="http://www.php.net/ucfirst">ucfirst</a><span class="src-sym">(</span><span class="src-var">$Val</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a1249"></a>                <span class="src-var">$string </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;. &quot;</span><span class="src-sym">,</span><span class="src-var">$split_dot</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1250"></a>        </li>
<li><a name="a1251"></a>                <span class="src-comm">/* Bei Slash aufsplitten */</span></li>
<li><a name="a1252"></a>                <span class="src-var">$split_slash </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">&quot;/&quot;</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1253"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$split_slash </span><span class="src-key">as </span><span class="src-var">$Key </span>=&gt; <span class="src-var">$Val</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$split_slash</span><span class="src-sym">[</span><span class="src-var">$Key</span><span class="src-sym">] </span>= <a href="http://www.php.net/ucfirst">ucfirst</a><span class="src-sym">(</span><span class="src-var">$Val</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a1254"></a>                <span class="src-var">$string </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;/&quot;</span><span class="src-sym">,</span><span class="src-var">$split_slash</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1255"></a>        </li>
<li><a name="a1256"></a>                <span class="src-comm">/* Bei BackSlash aufsplitten */</span></li>
<li><a name="a1257"></a>                <span class="src-var">$split_backslash </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">&quot;\\\\&quot;</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1258"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$split_backslash </span><span class="src-key">as </span><span class="src-var">$Key </span>=&gt; <span class="src-var">$Val</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$split_backslash</span><span class="src-sym">[</span><span class="src-var">$Key</span><span class="src-sym">] </span>= <a href="http://www.php.net/ucfirst">ucfirst</a><span class="src-sym">(</span><span class="src-var">$Val</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a1259"></a>                <span class="src-var">$string </span>= <a href="http://www.php.net/join">join</a><span class="src-sym">(</span><span class="src-str">&quot;\\&quot;</span><span class="src-sym">,</span><span class="src-var">$split_backslash</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1260"></a>        </li>
<li><a name="a1261"></a>                unset<span class="src-sym">(</span><span class="src-var">$split_space</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1262"></a>                unset<span class="src-sym">(</span><span class="src-var">$split_line</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1263"></a>                unset<span class="src-sym">(</span><span class="src-var">$split_slash</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1264"></a>                </li>
<li><a name="a1265"></a>            <span class="src-sym">}</span></li>
<li><a name="a1266"></a>    </li>
<li><a name="a1267"></a>            <span class="src-comm">/* Whitespaces am Beginn und Ende entfernen */</span></li>
<li><a name="a1268"></a>            <span class="src-var">$string </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">#(^ | $)#</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1269"></a>    </li>
<li><a name="a1270"></a>            <span class="src-comm">/* Datumsangaben wieder richtigstellen */</span></li>
<li><a name="a1271"></a>            <span class="src-var">$string </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;#(\d+\.) (\d+\.) (\d+)#&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;\\1\\2\\3&quot;</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1272"></a>            </li>
<li><a name="a1273"></a>            <span class="src-key">return </span><span class="src-var">$string</span><span class="src-sym">;</span></li>
<li><a name="a1274"></a>        </li>
<li><a name="a1275"></a>        <span class="src-sym">}</span></li>
<li><a name="a1276"></a>&nbsp;</li>
<li><a name="a1277"></a>&nbsp;</li>
<li><a name="a1278"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a1279"></a>        </li>
<li><a name="a1280"></a>        </li>
<li><a name="a1281"></a>        <span class="src-doc">/**</span></li>
<li><a name="a1282"></a><span class="src-doc">         *</span></li>
<li><a name="a1283"></a><span class="src-doc">         *</span></li>
<li><a name="a1284"></a><span class="src-doc">         *</span></li>
<li><a name="a1285"></a><span class="src-doc">         */</span></li>
<li><a name="a1286"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodreplace_specialChars">replace_specialChars</a><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">)</span></li>
<li><a name="a1287"></a>        <span class="src-sym">{</span></li>
<li><a name="a1288"></a>        <span class="src-sym">}</span></li>
<li><a name="a1289"></a>&nbsp;</li>
<li><a name="a1290"></a>&nbsp;</li>
<li><a name="a1291"></a>        <span class="src-comm">/* ########################################################## */</span></li>
<li><a name="a1292"></a>        </li>
<li><a name="a1293"></a>        </li>
<li><a name="a1294"></a>        <span class="src-doc">/**</span></li>
<li><a name="a1295"></a><span class="src-doc">         *</span></li>
<li><a name="a1296"></a><span class="src-doc">         *</span></li>
<li><a name="a1297"></a><span class="src-doc">         *</span></li>
<li><a name="a1298"></a><span class="src-doc">         */</span></li>
<li><a name="a1299"></a>        <span class="src-key">function </span><a href="../esiform/esiform.html#methodreturn_textSpaces">return_textSpaces</a><span class="src-sym">(</span><span class="src-var">$count</span><span class="src-sym">)</span></li>
<li><a name="a1300"></a>        <span class="src-sym">{</span></li>
<li><a name="a1301"></a>            <span class="src-var">$spaces </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a1302"></a>            <span class="src-key">for</span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">;</span><span class="src-var">$i</span>&lt;<span class="src-var">$count</span><span class="src-sym">;</span><span class="src-var">$i</span>++<span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$spaces </span>.= <span class="src-str">' '</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a1303"></a>            <span class="src-key">return </span><span class="src-var">$spaces</span><span class="src-sym">;</span></li>
<li><a name="a1304"></a>        <span class="src-sym">}</span></li>
<li><a name="a1305"></a>        </li>
<li><a name="a1306"></a>    <span class="src-sym">}</span></li>
<li><a name="a1307"></a>&nbsp;</li>
<li><a name="a1308"></a><span class="src-php">?&gt;</span></li>
</ol></pre>
</div>
	<p class="notes" id="credit">
		Documentation generated on Mon, 19 Jul 2010 20:33:22 -0500 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.3.0RC3</a>
	</p>
	</body>
</html>